\hypertarget{usb__pd__connect_8c}{\section{pd/usb\-\_\-pd\-\_\-connect.c File Reference}
\label{usb__pd__connect_8c}\index{pd/usb\-\_\-pd\-\_\-connect.\-c@{pd/usb\-\_\-pd\-\_\-connect.\-c}}
}
{\ttfamily \#include \char`\"{}usb\-\_\-pd\-\_\-config.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\-\_\-pd.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\-\_\-pd\-\_\-phy.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\-\_\-pd\-\_\-interface.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\-\_\-pd\-\_\-timer.\-h\char`\"{}}\\*
Include dependency graph for usb\-\_\-pd\-\_\-connect.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{usb__pd__connect_8c_a4815e5a6e31e08552d375c406033595d}{P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E}~(0)
\item 
\#define \hyperlink{usb__pd__connect_8c_a5b3884cef2d36a4a5191fdb06e46a4ca}{A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}~1
\item 
\#define \hyperlink{usb__pd__connect_8c_a8dfda9afd9cc706de73b3fba06e84aa2}{A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E}~1
\item 
\#define \hyperlink{usb__pd__connect_8c_a295158f58a5029523c0bd8408448920b}{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y}~60
\item 
\#define \hyperlink{usb__pd__connect_8c_a27f4f7afbf32e4016e178842c86392ce}{T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y}~(100 -\/ (\hyperlink{usb__pd__connect_8c_a295158f58a5029523c0bd8408448920b}{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y}))
\item 
\#define \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}~\hyperlink{usb__pd__timer_8h_a3d7e832f23ba73275f9245159dfe475c}{m\-Sec}(12)  /$\ast$ 10 $\sim$ 20 ms $\ast$/
\item 
\#define \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}~\hyperlink{usb__pd__timer_8h_a3d7e832f23ba73275f9245159dfe475c}{m\-Sec}(105) /$\ast$ 100 $\sim$ 200 ms $\ast$/
\item 
\#define \hyperlink{usb__pd__connect_8c_a34edde92299eeb75ab5a6107a0f76f78}{T\-\_\-\-D\-R\-P}~\hyperlink{usb__pd__timer_8h_a3d7e832f23ba73275f9245159dfe475c}{m\-Sec}(70)
\item 
\#define \hyperlink{usb__pd__connect_8c_a61940c99c3548678de15e41bbce15ad1}{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y}~\hyperlink{usb__pd__timer_8h_a3d7e832f23ba73275f9245159dfe475c}{m\-Sec}(100)         /$\ast$ 75ms $\sim$ 150ms $\ast$/
\item 
\#define \hyperlink{usb__pd__connect_8c_af30335a931e59303338047bc3f3f8e80}{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K}~(150) /$\ast$ 75ms $\sim$ 150ms $\ast$/
\item 
\#define \hyperlink{usb__pd__connect_8c_aac5d77f7aac07f7fa9cc26d3df108017}{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T}~\hyperlink{usb__pd__timer_8h_a3d7e832f23ba73275f9245159dfe475c}{m\-Sec}(310)    /$\ast$ Use 300 as min in sim, Needs to have margin for H\-W C\-C debounce (real value) $\ast$/
\item 
\#define \hyperlink{usb__pd__connect_8c_a542cb2e58a68a01a625cfbc492a3c81a}{T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T}~\hyperlink{usb__pd__timer_8h_a3d7e832f23ba73275f9245159dfe475c}{m\-Sec}(1)   /$\ast$ Select a small time to keep comptability with regression disconnect timing. $\ast$/
\item 
\#define \hyperlink{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C}~(((\hyperlink{usb__pd__connect_8c_a34edde92299eeb75ab5a6107a0f76f78}{T\-\_\-\-D\-R\-P}) $\ast$ (\hyperlink{usb__pd__connect_8c_a295158f58a5029523c0bd8408448920b}{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y})) / 100)
\item 
\#define \hyperlink{usb__pd__connect_8c_a837f610221411da8297162bb2ee1d213}{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K}~(((\hyperlink{usb__pd__connect_8c_a34edde92299eeb75ab5a6107a0f76f78}{T\-\_\-\-D\-R\-P}) $\ast$ (\hyperlink{usb__pd__connect_8c_a27f4f7afbf32e4016e178842c86392ce}{T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y})) / 100)
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef enum \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30af}{\-\_\-vbus\-\_\-discharge} \hyperlink{usb__pd__connect_8c_a930b933b988648ada54caf08a6a01d68}{vbus\-\_\-discharge\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30af}{\-\_\-vbus\-\_\-discharge} \{ \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{k\-Vbus\-\_\-\-No\-Discharge} = 0, 
\hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{k\-Vbus\-\_\-\-Apply\-Typec\-Discharge}, 
\hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa7db50d892d990fc709cc55893912a229}{k\-Vbus\-\_\-\-Typec\-Discharge}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa}{P\-D\-\_\-\-Dpm\-Discharge\-Vbus} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t enable)
\item 
\hyperlink{group__usb__pd__stack_ga04a1f331d9807a70ab9bb753f5ed1c80}{pd\-\_\-status\-\_\-t} \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{P\-D\-\_\-\-Phy\-Control} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint32\-\_\-t control, void $\ast$param)
\item 
static uint8\-\_\-t \hyperlink{usb__pd__connect_8c_ab61b3d8329ec92553e670b6b0997fa81}{P\-D\-\_\-\-Connect\-State} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance)
\item 
static void \hyperlink{usb__pd__connect_8c_a0328bd52ba61da793f163660077a0076}{P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance)
\item 
static void \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{P\-D\-\_\-\-Connect\-Setup\-New\-State} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t pr\-Swap)
\item 
static void \hyperlink{usb__pd__connect_8c_af6d40e216e9c36436e8363ff28113a3a}{P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static void \hyperlink{usb__pd__connect_8c_a6313417f32370723f208ee8129f7348b}{P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static void \hyperlink{usb__pd__connect_8c_a4cb64b10c04da73729388d11be51338e}{P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static void \hyperlink{usb__pd__connect_8c_ae84ce27d88537e1fb4335d7cb8a304a5}{P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static void \hyperlink{usb__pd__connect_8c_ad9e61e9e67e7d53a66151eae69b658d8}{P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static void \hyperlink{usb__pd__connect_8c_a3941fedd707bcdc334532b184d27787f}{P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static void \hyperlink{usb__pd__connect_8c_a0144954fa9035cc4e57c20a6a32713c8}{P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t cc1\-State, uint8\-\_\-t cc2\-State)
\item 
static \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338}{Type\-C\-State\-\_\-t} \hyperlink{usb__pd__connect_8c_a6147b33e99b7812c8de585d73af2f2c4}{P\-D\-\_\-\-Connect\-State\-Machine} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance)
\item 
void \hyperlink{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff}{P\-D\-\_\-\-Connect\-Set\-Power\-Progress} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t state)
\item 
\hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338}{Type\-C\-State\-\_\-t} \hyperlink{usb__pd__connect_8c_aa173143bdf6b1a4a301e5576b364d5d6}{P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint32\-\_\-t typec\-Role)
\item 
void \hyperlink{usb__pd__connect_8c_ac1262f667cd36f90f205a468ba59b1d4}{P\-D\-\_\-\-Connect\-Init\-Role} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint32\-\_\-t typec\-Role, uint8\-\_\-t error\-Recovery)
\item 
void \hyperlink{usb__pd__connect_8c_a3aa051f964b97e729b999996b3cf4efe}{P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t power\-Role)
\item 
void \hyperlink{usb__pd__connect_8c_af415d8897be39b06937aa0c1316abca9}{P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance, uint8\-\_\-t pd\-Connected)
\item 
uint8\-\_\-t \hyperlink{usb__pd__connect_8c_a25116c60801fe4f4def90e3e42614b54}{P\-D\-\_\-\-Connect\-Check} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance)
\item 
\hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338}{Type\-C\-State\-\_\-t} \hyperlink{usb__pd__connect_8c_a1fb3d7072f44bb8959b640f553c45e02}{P\-D\-\_\-\-Connect\-Get\-State\-Machine} (\hyperlink{usb__pd__interface_8h_a1deb7ee8a70201e41a45bef369b5d692}{pd\-\_\-instance\-\_\-t} $\ast$pd\-Instance)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{usb__pd__connect_8c_a8dfda9afd9cc706de73b3fba06e84aa2}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E@{A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E}}
\index{A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E@{A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-F\-I\-G\-U\-R\-E~1}}\label{usb__pd__connect_8c_a8dfda9afd9cc706de73b3fba06e84aa2}
\hypertarget{usb__pd__connect_8c_a5b3884cef2d36a4a5191fdb06e46a4ca}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E@{A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}}
\index{A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E@{A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\-U\-D\-I\-O\-\_\-\-A\-C\-C\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E~1}}\label{usb__pd__connect_8c_a5b3884cef2d36a4a5191fdb06e46a4ca}
\hypertarget{usb__pd__connect_8c_a4815e5a6e31e08552d375c406033595d}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E@{P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E}}
\index{P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E@{P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\-D\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-O\-L\-D\-\_\-\-I\-N\-T\-E\-R\-F\-A\-C\-E~(0)}}\label{usb__pd__connect_8c_a4815e5a6e31e08552d375c406033595d}
\hypertarget{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E@{T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}}
\index{T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E@{T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-C\-C\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E~{\bf m\-Sec}(105) /$\ast$ 100 $\sim$ 200 ms $\ast$/}}\label{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}
\hypertarget{usb__pd__connect_8c_a34edde92299eeb75ab5a6107a0f76f78}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P@{T\-\_\-\-D\-R\-P}}
\index{T\-\_\-\-D\-R\-P@{T\-\_\-\-D\-R\-P}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P~{\bf m\-Sec}(70)}}\label{usb__pd__connect_8c_a34edde92299eeb75ab5a6107a0f76f78}
\hypertarget{usb__pd__connect_8c_a27f4f7afbf32e4016e178842c86392ce}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y@{T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y@{T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y~(100 -\/ ({\bf T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y}))}}\label{usb__pd__connect_8c_a27f4f7afbf32e4016e178842c86392ce}
\hypertarget{usb__pd__connect_8c_a295158f58a5029523c0bd8408448920b}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y@{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y@{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y~60}}\label{usb__pd__connect_8c_a295158f58a5029523c0bd8408448920b}
\hypertarget{usb__pd__connect_8c_a837f610221411da8297162bb2ee1d213}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K@{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K@{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-N\-K~((({\bf T\-\_\-\-D\-R\-P}) $\ast$ ({\bf T\-\_\-\-D\-R\-P\-\_\-\-S\-N\-K\-\_\-\-D\-U\-T\-Y})) / 100)}}\label{usb__pd__connect_8c_a837f610221411da8297162bb2ee1d213}
\hypertarget{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C@{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C@{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-T\-O\-G\-G\-L\-E\-\_\-\-S\-R\-C~((({\bf T\-\_\-\-D\-R\-P}) $\ast$ ({\bf T\-\_\-\-D\-R\-P\-\_\-\-S\-R\-C\-\_\-\-D\-U\-T\-Y})) / 100)}}\label{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}
\hypertarget{usb__pd__connect_8c_a61940c99c3548678de15e41bbce15ad1}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y@{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y@{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y~{\bf m\-Sec}(100)         /$\ast$ 75ms $\sim$ 150ms $\ast$/}}\label{usb__pd__connect_8c_a61940c99c3548678de15e41bbce15ad1}
\hypertarget{usb__pd__connect_8c_af30335a931e59303338047bc3f3f8e80}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K@{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K@{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-F\-O\-R\-\_\-\-T\-R\-Y\-\_\-\-S\-N\-K~(150) /$\ast$ 75ms $\sim$ 150ms $\ast$/}}\label{usb__pd__connect_8c_af30335a931e59303338047bc3f3f8e80}
\hypertarget{usb__pd__connect_8c_aac5d77f7aac07f7fa9cc26d3df108017}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T@{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T}}
\index{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T@{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-D\-R\-P\-\_\-\-T\-R\-Y\-\_\-\-W\-A\-I\-T~{\bf m\-Sec}(310)    /$\ast$ Use 300 as min in sim, Needs to have margin for H\-W C\-C debounce (real value) $\ast$/}}\label{usb__pd__connect_8c_aac5d77f7aac07f7fa9cc26d3df108017}
\hypertarget{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E@{T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}}
\index{T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E@{T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-P\-D\-\_\-\-D\-E\-B\-O\-U\-N\-C\-E~{\bf m\-Sec}(12)  /$\ast$ 10 $\sim$ 20 ms $\ast$/}}\label{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}
\hypertarget{usb__pd__connect_8c_a542cb2e58a68a01a625cfbc492a3c81a}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T@{T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T}}
\index{T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T@{T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-\_\-\-S\-I\-N\-K\-\_\-\-D\-I\-S\-C\-O\-N\-N\-E\-C\-T~{\bf m\-Sec}(1)   /$\ast$ Select a small time to keep comptability with regression disconnect timing. $\ast$/}}\label{usb__pd__connect_8c_a542cb2e58a68a01a625cfbc492a3c81a}


\subsection{Typedef Documentation}
\hypertarget{usb__pd__connect_8c_a930b933b988648ada54caf08a6a01d68}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!vbus\-\_\-discharge\-\_\-t@{vbus\-\_\-discharge\-\_\-t}}
\index{vbus\-\_\-discharge\-\_\-t@{vbus\-\_\-discharge\-\_\-t}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{vbus\-\_\-discharge\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef enum {\bf \-\_\-vbus\-\_\-discharge}  {\bf vbus\-\_\-discharge\-\_\-t}}}\label{usb__pd__connect_8c_a930b933b988648ada54caf08a6a01d68}


\subsection{Enumeration Type Documentation}
\hypertarget{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30af}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!\-\_\-vbus\-\_\-discharge@{\-\_\-vbus\-\_\-discharge}}
\index{\-\_\-vbus\-\_\-discharge@{\-\_\-vbus\-\_\-discharge}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{\-\_\-vbus\-\_\-discharge}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf \-\_\-vbus\-\_\-discharge}}}\label{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30af}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{k\-Vbus\-\_\-\-No\-Discharge@{k\-Vbus\-\_\-\-No\-Discharge}!usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}}\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!k\-Vbus\-\_\-\-No\-Discharge@{k\-Vbus\-\_\-\-No\-Discharge}}\item[{\em 
\hypertarget{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{k\-Vbus\-\_\-\-No\-Discharge}\label{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}
}]\index{k\-Vbus\-\_\-\-Apply\-Typec\-Discharge@{k\-Vbus\-\_\-\-Apply\-Typec\-Discharge}!usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}}\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!k\-Vbus\-\_\-\-Apply\-Typec\-Discharge@{k\-Vbus\-\_\-\-Apply\-Typec\-Discharge}}\item[{\em 
\hypertarget{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{k\-Vbus\-\_\-\-Apply\-Typec\-Discharge}\label{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}
}]\index{k\-Vbus\-\_\-\-Typec\-Discharge@{k\-Vbus\-\_\-\-Typec\-Discharge}!usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}}\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!k\-Vbus\-\_\-\-Typec\-Discharge@{k\-Vbus\-\_\-\-Typec\-Discharge}}\item[{\em 
\hypertarget{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa7db50d892d990fc709cc55893912a229}{k\-Vbus\-\_\-\-Typec\-Discharge}\label{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa7db50d892d990fc709cc55893912a229}
}]\end{description}
\end{Desc}

\begin{DoxyCode}
62 \{
63     \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{kVbus\_NoDischarge} = 0,
64     \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge},
65     \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa7db50d892d990fc709cc55893912a229}{kVbus\_TypecDischarge},
66 \} \hyperlink{usb__pd__connect_8c_a930b933b988648ada54caf08a6a01d68}{vbus\_discharge\_t};
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{usb__pd__connect_8c_af415d8897be39b06937aa0c1316abca9}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail@{P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail}}
\index{P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail@{P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail}]{\setlength{\rightskip}{0pt plus 5cm}void P\-D\-\_\-\-Connect\-Alt\-Mode\-Enter\-Fail (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{pd\-Connected}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_af415d8897be39b06937aa0c1316abca9}

\begin{DoxyCode}
1766 \{
1767     \textcolor{keywordflow}{if} (pdConnected)
1768     \{
1769         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a52743b32e531cf3605d534ae3d2bf014}{TYPEC\_POWERED\_ACCESSORY})
1770         \{
1771             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a33dafd4e9c965a76d5bb1ac199374a5d}{TYPEC\_UNSUPPORTED\_ACCESSORY};
1772             \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
1773         \}
1774     \}
1775     \textcolor{keywordflow}{else}
1776     \{
1777         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a52743b32e531cf3605d534ae3d2bf014}{TYPEC\_POWERED\_ACCESSORY})
1778         \{
1779             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK};
1780             \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
1781         \}
1782     \}
1783 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_af415d8897be39b06937aa0c1316abca9_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_af415d8897be39b06937aa0c1316abca9_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a25116c60801fe4f4def90e3e42614b54}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Check@{P\-D\-\_\-\-Connect\-Check}}
\index{P\-D\-\_\-\-Connect\-Check@{P\-D\-\_\-\-Connect\-Check}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Check}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t P\-D\-\_\-\-Connect\-Check (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_a25116c60801fe4f4def90e3e42614b54}

\begin{DoxyCode}
1786 \{
1787     \hyperlink{usb__pd__connect_8c_a6147b33e99b7812c8de585d73af2f2c4}{PD\_ConnectStateMachine}(pdInstance);
1788     \textcolor{keywordflow}{return} \hyperlink{usb__pd__connect_8c_ab61b3d8329ec92553e670b6b0997fa81}{PD\_ConnectState}(pdInstance);
1789 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a25116c60801fe4f4def90e3e42614b54_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a25116c60801fe4f4def90e3e42614b54_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_aa173143bdf6b1a4a301e5576b364d5d6}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State@{P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State}}
\index{P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State@{P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Type\-C\-State\-\_\-t} P\-D\-\_\-\-Connect\-Get\-Init\-Role\-State (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint32\-\_\-t}]{typec\-Role}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_aa173143bdf6b1a4a301e5576b364d5d6}

\begin{DoxyCode}
1608 \{
1609     \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338}{TypeCState\_t} newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ae804ea52cb577a1087ceedc86d227285}{TYPEC\_DISABLED};
1610 
1611     \textcolor{keywordflow}{switch} (typecRole)
1612     \{
1613         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a38da91c9c7115f0e6866a557601ad9b0}{kPowerConfig\_SourceOnly}:
1614         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9656266d9665fce5cad114863e549798}{kPowerConfig\_SourceDefault}:
1615             newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
1616             \textcolor{keywordflow}{break};
1617 
1618         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a437645be6176b52731290288dfdb65de}{kPowerConfig\_SinkOnly}:
1619         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9aff4b2380c8b265bbbe69d2eaa1ab207c}{kPowerConfig\_SinkDefault}:
1620             newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK};
1621             \textcolor{keywordflow}{break};
1622 
1623         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}:
1624         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a2669bea019494464b15f2a4e4904d385}{kPowerConfig\_DRPSourcingDevice}:
1625         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9aba8782be77976d2ffc9830f1106e80f3}{kPowerConfig\_DRPSinkingHost}:
1626             \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) &&
1627                 (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a6e72ee6532ef61497b162a28b4500433}{drpTryFunction} == 
      \hyperlink{group__usb__pd__stack_gga4794fa8903a011ba6f0be0f04925411ea4326df028c06c1618941dfac6645decd}{kTypecTry\_Src}))
1628             \{
1629                 newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338af63a615d3eb1e5a83c087437209c81b9}{TYPEC\_TOGGLE\_SRC\_FIRST};
1630             \}
1631             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) &&
1632                      (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->
      \hyperlink{struct__pd__power__port__config_a6e72ee6532ef61497b162a28b4500433}{drpTryFunction} == \hyperlink{group__usb__pd__stack_gga4794fa8903a011ba6f0be0f04925411ea96a98ce2756ccbcd3c300db89ae9be67}{kTypecTry\_Snk}))
1633             \{
1634                 newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST};
1635             \}
1636             \textcolor{keywordflow}{else}
1637             \{
1638                 newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338af63a615d3eb1e5a83c087437209c81b9}{TYPEC\_TOGGLE\_SRC\_FIRST};
1639             \}
1640             \textcolor{keywordflow}{break};
1641 
1642         \textcolor{keywordflow}{default}:
1643             \textcolor{keywordflow}{break}; \textcolor{comment}{/* error */}
1644     \}
1645 
1646     \textcolor{keywordflow}{return} newState;
1647 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_aa173143bdf6b1a4a301e5576b364d5d6_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a1fb3d7072f44bb8959b640f553c45e02}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Get\-State\-Machine@{P\-D\-\_\-\-Connect\-Get\-State\-Machine}}
\index{P\-D\-\_\-\-Connect\-Get\-State\-Machine@{P\-D\-\_\-\-Connect\-Get\-State\-Machine}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Get\-State\-Machine}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Type\-C\-State\-\_\-t} P\-D\-\_\-\-Connect\-Get\-State\-Machine (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_a1fb3d7072f44bb8959b640f553c45e02}

\begin{DoxyCode}
1792 \{
1793     \textcolor{keywordflow}{return} pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState};
1794 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a1fb3d7072f44bb8959b640f553c45e02_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_ac1262f667cd36f90f205a468ba59b1d4}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Init\-Role@{P\-D\-\_\-\-Connect\-Init\-Role}}
\index{P\-D\-\_\-\-Connect\-Init\-Role@{P\-D\-\_\-\-Connect\-Init\-Role}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Init\-Role}]{\setlength{\rightskip}{0pt plus 5cm}void P\-D\-\_\-\-Connect\-Init\-Role (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint32\-\_\-t}]{typec\-Role, }
\item[{uint8\-\_\-t}]{error\-Recovery}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_ac1262f667cd36f90f205a468ba59b1d4}

\begin{DoxyCode}
1657 \{
1658     \textcolor{comment}{//state in Type-C Spec}
1659     \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338}{TypeCState\_t} newState;
1660     uint32\_t infoVal;
1661 
1662     newState = pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState};
1663     pdInstance->\hyperlink{struct__pd__instance_aea1b390f81517cb7ef24eacda944f4ec}{enterAttachedSrcFromAttachWaitSNK} = 0;
1664 
1665     \textcolor{comment}{/*}
1666 \textcolor{comment}{    The ErrorRecovery state is where the port removes the terminations from the CC1 and CC2}
1667 \textcolor{comment}{    pins for tErrorRecovery followed by transitioning to the appropriate Unattached.SNK or}
1668 \textcolor{comment}{    Unattached.SRC state based on port type. This is the equivalent of forcing a detach event}
1669 \textcolor{comment}{    and looking for a new attach.}
1670 \textcolor{comment}{    */}
1671     \textcolor{comment}{/* error recovery 两件事}
1672 \textcolor{comment}{     * 1. remove terminations for CC1 and CC2 for tErrorRecovery}
1673 \textcolor{comment}{     * 2. transition to unattached state}
1674 \textcolor{comment}{     */}
1675     \textcolor{keywordflow}{if} (errorRecovery)
1676     \{
1677         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} != \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abbb8f217eb3a1e48e8801810e67c94b6}{TYPEC\_ERROR\_RECOVERY})
1678         \{
1679             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
1680             \hyperlink{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff}{PD\_ConnectSetPowerProgress}(pdInstance, 
      \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable});
1681             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abbb8f217eb3a1e48e8801810e67c94b6}{TYPEC\_ERROR\_RECOVERY};
1682             \textcolor{comment}{//设置CC，包括Vconn}
1683             \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
1684         \}
1685 
1686         \textcolor{comment}{// 这里是tErrorRecovery的延迟，那么上面是做remove terminations?}
1687         \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa918421e184737508bd7e4b501a70cb13}{tDelayTimer}, 
      \hyperlink{usb__pd__timer_8h_a03f942c439c95ea4ea901cd5e1d66e55}{T\_ERROR\_RECOVERY});
1688 
1689         \textcolor{keywordflow}{while} (!\hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa918421e184737508bd7e4b501a70cb13}{tDelayTimer}))
1690         \{
1691         \}
1692     \}
1693     \textcolor{comment}{// Question: 经过上述操作可以保证state transition to unattached.xxx ?}
1694 
1695     \textcolor{comment}{// Question: 设置power progress -> stable的作用 ? }
1696     \textcolor{comment}{/* 以下四种都是初始状态 */}
1697     \textcolor{comment}{// set phy pwr\_inprogress state}
1698     \hyperlink{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff}{PD\_ConnectSetPowerProgress}(pdInstance, 
      \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable});
1699     pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{kVbus\_NoDischarge};
1700     pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
1701     pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ae804ea52cb577a1087ceedc86d227285}{TYPEC\_DISABLED};
1702 
1703     \textcolor{comment}{// set cc initial state according to power role, confirm cc state tendency}
1704     newState = \hyperlink{usb__pd__connect_8c_aa173143bdf6b1a4a301e5576b364d5d6}{PD\_ConnectGetInitRoleState}(pdInstance, typecRole);
1705     \textcolor{comment}{// 注意，这里的curConnectState在上面刚刚被置为TYPEC\_DISABLED}
1706     \textcolor{keywordflow}{if} (newState != pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState})
1707     \{
1708         \textcolor{comment}{/* In the process of connecting, just change the role */}
1709         \textcolor{keywordflow}{if} (((newState == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK}) && (pdInstance->
      \hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK})) ||
1710             ((newState == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC}) && (pdInstance->
      \hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC})))
1711         \{
1712             \textcolor{comment}{/* continue the original state machine */}
1713         \}
1714         \textcolor{comment}{/* Not connected */}
1715         \textcolor{keywordflow}{else}
1716         \{
1717             \textcolor{keywordflow}{if} (newState != \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ae804ea52cb577a1087ceedc86d227285}{TYPEC\_DISABLED})
1718             \{
1719                 \textcolor{comment}{// get vbus info, save it to infoVal}
1720                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &infoVal);
1721                 \textcolor{keywordflow}{if} (infoVal & \hyperlink{group__usb__pd__phy__drv_gaa02e3880c4e9954439522efb9a6af5c5}{PD\_VBUS\_POWER\_STATE\_VSYS\_MASK})
1722                 \{
1723                     \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &infoVal);
1724                     \textcolor{keywordflow}{if} (!(infoVal & \hyperlink{group__usb__pd__phy__drv_gabf05bb09647628f3556c817e1f059175}{PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK}))
1725                     \{
1726                         \textcolor{comment}{/* VBUS Discharge:}
1727 \textcolor{comment}{                           If state is not disabled, and we are not in dead battery, enable vbus discharge
       on startup */}
1728                         pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge};
1729                     \}
1730                 \}
1731             \}
1732 
1733             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = newState;
1734             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
1735             \hyperlink{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff}{PD\_ConnectSetPowerProgress}(pdInstance, 
      \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable});
1736             \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 1);
1737         \}
1738     \}
1739 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ac1262f667cd36f90f205a468ba59b1d4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ac1262f667cd36f90f205a468ba59b1d4_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a0328bd52ba61da793f163660077a0076}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C@{P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C}}
\index{P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C@{P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-Set\-Monitor\-C\-C (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a0328bd52ba61da793f163660077a0076}

\begin{DoxyCode}
87 \{
88     \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} == \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid})
89     \{
90         pdInstance->\hyperlink{struct__pd__instance_ae190e16d15f42371ac82937f08371c98}{cc1Monitor} = 1;
91         pdInstance->\hyperlink{struct__pd__instance_af6e379f0550864c814e92c07732b6ea9}{cc2Monitor} = 1;
92     \}
93     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} == \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08dad8ccec791609837bd7b2cb928ba727b6}{kPD\_CC1})
94     \{
95         pdInstance->\hyperlink{struct__pd__instance_ae190e16d15f42371ac82937f08371c98}{cc1Monitor} = 1;
96         pdInstance->\hyperlink{struct__pd__instance_af6e379f0550864c814e92c07732b6ea9}{cc2Monitor} = 0;
97     \}
98     \textcolor{keywordflow}{else}
99     \{
100         pdInstance->\hyperlink{struct__pd__instance_ae190e16d15f42371ac82937f08371c98}{cc1Monitor} = 0;
101         pdInstance->\hyperlink{struct__pd__instance_af6e379f0550864c814e92c07732b6ea9}{cc2Monitor} = 1;
102     \}
103 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a0328bd52ba61da793f163660077a0076_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Set\-Power\-Progress@{P\-D\-\_\-\-Connect\-Set\-Power\-Progress}}
\index{P\-D\-\_\-\-Connect\-Set\-Power\-Progress@{P\-D\-\_\-\-Connect\-Set\-Power\-Progress}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Set\-Power\-Progress}]{\setlength{\rightskip}{0pt plus 5cm}void P\-D\-\_\-\-Connect\-Set\-Power\-Progress (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{state}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff}

\begin{DoxyCode}
1591 \{
1592     \textcolor{keywordflow}{if} ((state != \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771babd57680a848fb2ffdfcb7ce62b380348}{kVbusPower\_Invalid}) && (pdInstance->
      \hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} != state))
1593     \{
1594         \textcolor{comment}{// 设置power progress}
1595         pdInstance->\hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} = state;
1596         \textcolor{comment}{// 告知phy driver vbus的状态}
1597         \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4b062c83b48914ee8edc74523699871d}{PD\_PHY\_SET\_VBUS\_TRANSFORM\_STATE}
      , &state);
1598     \}
1599 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a83de99272e34bf7bad5146401157ccff_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a3aa051f964b97e729b999996b3cf4efe}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role@{P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role}}
\index{P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role@{P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role}]{\setlength{\rightskip}{0pt plus 5cm}void P\-D\-\_\-\-Connect\-Set\-P\-R\-Swap\-Role (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{power\-Role}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_a3aa051f964b97e729b999996b3cf4efe}

\begin{DoxyCode}
1742 \{
1743     \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338}{TypeCState\_t} newState;
1744 
1745     newState = pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState};
1746     \textcolor{keywordflow}{if} ((newState == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC}) && (powerRole == 
      \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink}))
1747     \{
1748         newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK};
1749     \}
1750     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((newState == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK}) && (powerRole == 
      \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource}))
1751     \{
1752         newState = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC};
1753     \}
1754     \textcolor{keywordflow}{else}
1755     \{
1756         \textcolor{keywordflow}{return}; \textcolor{comment}{/* ERROR */}
1757     \}
1758     \textcolor{keywordflow}{if} (newState != pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState})
1759     \{
1760         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = newState;
1761         \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 1);
1762     \}
1763 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a3aa051f964b97e729b999996b3cf4efe_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a3aa051f964b97e729b999996b3cf4efe_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-Setup\-New\-State@{P\-D\-\_\-\-Connect\-Setup\-New\-State}}
\index{P\-D\-\_\-\-Connect\-Setup\-New\-State@{P\-D\-\_\-\-Connect\-Setup\-New\-State}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-Setup\-New\-State}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-Setup\-New\-State (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{pr\-Swap}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}

\begin{DoxyCode}
109 \{
110     uint8\_t writeRegsNeeded = 1;
111     uint8\_t controlVal;
112     \textcolor{keyword}{enum}
113     \{
114         VCONN\_NO\_CHANGE,
115         VCONN\_FORCE\_OFF,
116         VCONN\_FORCE\_ON,
117     \} vconn\_en = VCONN\_FORCE\_OFF;
118     \hyperlink{struct__pd__attach__detection__param}{pd\_attach\_detection\_param\_t} attachDetecParam;
119     \hyperlink{struct__pd__detach__detection__param}{pd\_detach\_detection\_param\_t} detachDetecParam;
120 
121 \textcolor{preprocessor}{#if 0}
122 \textcolor{preprocessor}{}    \textcolor{comment}{/* Cancel timers across state change */}
123     \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer});
124     \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer});
125     \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer});
126 \textcolor{preprocessor}{#endif}
127 \textcolor{preprocessor}{}
128     \textcolor{comment}{/* State specific actions */}
129     \textcolor{keywordflow}{switch} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState})
130     \{
131         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abbb8f217eb3a1e48e8801810e67c94b6}{TYPEC\_ERROR\_RECOVERY}:
132         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ae804ea52cb577a1087ceedc86d227285}{TYPEC\_DISABLED}:
133             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edaf3f42b23f0c7f36bccf50060a41b11a8}{PD\_PHY\_RESET\_CONNECT\_DETECTION}, NULL);
134             \textcolor{keywordflow}{break};
135 
136         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338af63a615d3eb1e5a83c087437209c81b9}{TYPEC\_TOGGLE\_SRC\_FIRST}:
137             \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_afae58a0b309262dc37fac1f4f92c6d7b}{phyType} == \hyperlink{group__usb__pd__stack_gga8bd01601105e164bc0e0bb538aaa5c1ca822af45ba751bc878c6931b765585412}{kPD\_PhyPTN5100})
138             \{
139                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
140                 \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
141                 \textcolor{keywordflow}{return};
142             \}
143 \textcolor{preprocessor}{#if !(PD\_CONFIG\_OLD\_INTERFACE)}
144 \textcolor{preprocessor}{}            attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->
      \hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling});
145             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
146             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
147             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
148 \textcolor{preprocessor}{#else}
149 \textcolor{preprocessor}{}            \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SRC\_CONFIG\_ATTACH\_DETECTION, NULL);
150 \textcolor{preprocessor}{#endif}
151 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) ||
152                 (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a48a06d065d2a479f3ad3baf0786e954f}{TYPEC\_UNATTACHED\_ACCESSORY}))
153             \{
154                 \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}{T\_DRP\_TOGGLE\_SRC});
155             \}
156             \textcolor{keywordflow}{break};
157 
158 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT)}
159 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a48a06d065d2a479f3ad3baf0786e954f}{TYPEC\_UNATTACHED\_ACCESSORY}:
160 \textcolor{preprocessor}{#endif}
161 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC}:
162         \{
163             \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) &&
164                 (pdInstance->\hyperlink{struct__pd__instance_afae58a0b309262dc37fac1f4f92c6d7b}{phyType} == \hyperlink{group__usb__pd__stack_gga8bd01601105e164bc0e0bb538aaa5c1ca6f0eabe71ca45162254c941b34558d2c}{kPD\_PhyPTN5110}))
165             \{
166                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST};
167                 \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
168                 \textcolor{keywordflow}{return};
169             \}
170 \textcolor{preprocessor}{#if !(PD\_CONFIG\_OLD\_INTERFACE)}
171 \textcolor{preprocessor}{}            attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->
      \hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling});
172             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
173             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
174             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
175 \textcolor{preprocessor}{#else}
176 \textcolor{preprocessor}{}            \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SRC\_CONFIG\_ATTACH\_DETECTION, NULL);
177 \textcolor{preprocessor}{#endif}
178 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) ||
179                 (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a48a06d065d2a479f3ad3baf0786e954f}{TYPEC\_UNATTACHED\_ACCESSORY}))
180             \{
181                 \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}{T\_DRP\_TOGGLE\_SRC});
182             \}
183             \textcolor{keywordflow}{break};
184         \}
185 
186         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST}:
187             \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_afae58a0b309262dc37fac1f4f92c6d7b}{phyType} == \hyperlink{group__usb__pd__stack_gga8bd01601105e164bc0e0bb538aaa5c1ca822af45ba751bc878c6931b765585412}{kPD\_PhyPTN5100})
188             \{
189                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK};
190                 \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
191                 \textcolor{keywordflow}{return};
192             \}
193 \textcolor{preprocessor}{#if !(PD\_CONFIG\_OLD\_INTERFACE)}
194 \textcolor{preprocessor}{}            attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->
      \hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling});
195             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink};
196             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a935484922f134dd28059b0888fbd416e}{deviceType} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->
      \hyperlink{struct__pd__instance__config_a68e8aae835b95ae67d48701973864acf}{deviceType};
197             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
198             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
199 \textcolor{preprocessor}{#else}
200 \textcolor{preprocessor}{}            controlVal = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSnkRole;
201             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SNK\_CONFIG\_ATTACH\_DETECTION, &controlVal)
      ;
202 \textcolor{preprocessor}{#endif}
203 \textcolor{preprocessor}{}            \textcolor{comment}{/* drp toggle and sink accessory toggle */}
204             \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) ||
205                 (\hyperlink{usb__pd__config_8h_a817f4917f983cd86ca2f8e03713a490d}{PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT}))
206             \{
207                 \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_a837f610221411da8297162bb2ee1d213}{T\_DRP\_TOGGLE\_SNK});
208             \}
209             \textcolor{keywordflow}{break};
210 
211         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK}:
212         \{
213             \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) &&
214                 (pdInstance->\hyperlink{struct__pd__instance_afae58a0b309262dc37fac1f4f92c6d7b}{phyType} == \hyperlink{group__usb__pd__stack_gga8bd01601105e164bc0e0bb538aaa5c1ca6f0eabe71ca45162254c941b34558d2c}{kPD\_PhyPTN5110}))
215             \{
216                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST};
217                 \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
218                 \textcolor{keywordflow}{return};
219             \}
220 
221 \textcolor{preprocessor}{#if !(PD\_CONFIG\_OLD\_INTERFACE)}
222 \textcolor{preprocessor}{}            attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->
      \hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling});
223             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink};
224             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a935484922f134dd28059b0888fbd416e}{deviceType} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->
      \hyperlink{struct__pd__instance__config_a68e8aae835b95ae67d48701973864acf}{deviceType};
225             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
226             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
227 \textcolor{preprocessor}{#else}
228 \textcolor{preprocessor}{}            controlVal = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSnkRole;
229             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SNK\_CONFIG\_ATTACH\_DETECTION, &controlVal)
      ;
230 \textcolor{preprocessor}{#endif}
231 \textcolor{preprocessor}{}            \textcolor{comment}{/* drp toggle and sink accessory toggle */}
232             \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) ||
233                 (\hyperlink{usb__pd__config_8h_a817f4917f983cd86ca2f8e03713a490d}{PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT}))
234             \{
235                 \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_a837f610221411da8297162bb2ee1d213}{T\_DRP\_TOGGLE\_SNK});
236             \}
237             \textcolor{keywordflow}{break};
238         \}
239 
240         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC}:
241             controlVal = 1;
242             \textcolor{comment}{/* Preserve discharge in this state - exit condition is dependent on VSafe0V */}
243             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edaf239b7319f38356c2dffdb8bda5cb873}{PD\_PHY\_CONTROL\_VBUS\_DETECT}, &
      controlVal);
244             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\_CC\_DEBOUNCE});
245             \textcolor{comment}{/* vconn\_en = VCONN\_NO\_CHANGE; */}
246             writeRegsNeeded = 0;
247             \textcolor{keywordflow}{break};
248 
249         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK}:
250             controlVal = 1;
251             \textcolor{comment}{/* Preserve discharge in this state - exit condition is dependent on VSafe0V */}
252             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edaf239b7319f38356c2dffdb8bda5cb873}{PD\_PHY\_CONTROL\_VBUS\_DETECT}, &
      controlVal);
253             \textcolor{comment}{/* Set the CC debounce time once at state entry, will not be reset on CC change */}
254             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\_CC\_DEBOUNCE});
255             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\_PD\_DEBOUNCE});
256             writeRegsNeeded = 0;
257             \textcolor{keywordflow}{break};
258 
259         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC}:
260             pdInstance->\hyperlink{struct__pd__instance_a519457e415e4eb39231c3e32316ffc83}{callbackFns}->\hyperlink{struct__pd__power__callback_a81922cf6a4f22bcee69123e95fac7758}{PD\_SrcTurnOnTypeCVbus}(pdInstance->
      \hyperlink{struct__pd__instance_a0eb7710a55cb5eb2a57355d772b26f74}{callbackParam}, \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable});
261             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa18eca9dd0eea417e318901214fabeab2}{kTYPEC\_ConnectSource};
262 \textcolor{preprocessor}{#if (PD\_CONFIG\_OLD\_INTERFACE)}
263 \textcolor{preprocessor}{}            controlVal = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa18eca9dd0eea417e318901214fabeab2}{kTYPEC\_ConnectSource};
264             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SET\_TYPEC\_ROLE, &controlVal);
265 \textcolor{preprocessor}{#endif}
266 \textcolor{preprocessor}{}            controlVal = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
267             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadfcf4cb3c3f2b330b326278bac666a80}{PD\_PHY\_CONNECT\_SET\_CC}, &controlVal)
      ;
268 \textcolor{preprocessor}{#if !(PD\_CONFIG\_OLD\_INTERFACE)}
269 \textcolor{preprocessor}{}            detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
270             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
271             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
272             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a9ba36d0a45cb600d503944f7edd5db7d}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
273             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
274 \textcolor{preprocessor}{#else}
275 \textcolor{preprocessor}{}            controlVal = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSrcCurrent;
276             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda47b31ad92865627f7e074f52e8532854}{PD\_PHY\_SRC\_SET\_TYPEC\_CURRENT\_CAP}, &controlVal);
277             controlVal = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa18eca9dd0eea417e318901214fabeab2}{kTYPEC\_ConnectSource};
278             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SRC\_CONFIG\_DETACH\_DETECTION, &controlVal)
      ;
279 \textcolor{preprocessor}{#endif}
280 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (prSwap)
281             \{
282                 \textcolor{comment}{/* Don't change ra\_present or vconn */}
283                 vconn\_en = VCONN\_NO\_CHANGE;
284             \}
285             \textcolor{keywordflow}{else}
286             \{
287                 \textcolor{keywordflow}{if} (((pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} == \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da274bd8ffe2629a7d89fb09b4848e172d}{kPD\_CC2}) && (pdInstance->
      \hyperlink{struct__pd__instance_a5905690cc5a12a0758be0574d4bc262e}{raPresent} == 1)) ||
288                     ((pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} == \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08dad8ccec791609837bd7b2cb928ba727b6}{kPD\_CC1}) && (pdInstance->
      \hyperlink{struct__pd__instance_a5905690cc5a12a0758be0574d4bc262e}{raPresent} == 2)))
289                 \{
290                     vconn\_en = VCONN\_FORCE\_ON;
291                 \}
292                 \textcolor{keywordflow}{else}
293                 \{
294                     vconn\_en = VCONN\_NO\_CHANGE;
295                 \}
296             \}
297             \textcolor{keywordflow}{break};
298 
299         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK}:
300             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baae6a08556f4bb1b80036fb9337d17174c}{kTYPEC\_ConnectSink};
301 \textcolor{preprocessor}{#if (PD\_CONFIG\_OLD\_INTERFACE)}
302 \textcolor{preprocessor}{}            controlVal = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baae6a08556f4bb1b80036fb9337d17174c}{kTYPEC\_ConnectSink};
303             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SET\_TYPEC\_ROLE, &controlVal);
304 \textcolor{preprocessor}{#endif}
305 \textcolor{preprocessor}{}            controlVal = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
306             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadfcf4cb3c3f2b330b326278bac666a80}{PD\_PHY\_CONNECT\_SET\_CC}, &controlVal)
      ;
307 \textcolor{preprocessor}{#if !(PD\_CONFIG\_OLD\_INTERFACE)}
308 \textcolor{preprocessor}{}            detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink};
309             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
310             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
311             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ada72749350ff49cdeedcd58803d75d99}{snkDetachDetectCCOpen} = 0;
312             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
313 \textcolor{preprocessor}{#else}
314 \textcolor{preprocessor}{}            controlVal = \hyperlink{usb__pd__config_8h_a6c7fdd8725deeb9b9fde706e9413f7cf}{PD\_CONFIG\_SINK\_DETACH\_DETECT\_WAY};
315             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_SNK\_CONFIG\_DETACH\_DETECTION, &controlVal)
      ;
316 \textcolor{preprocessor}{#endif}
317 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (prSwap)
318             \{
319                 \textcolor{comment}{/* Don't change ra\_present or vconn */}
320                 vconn\_en = VCONN\_NO\_CHANGE;
321             \}
322             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edae1406149d183dba960809596aa525528}{PD\_PHY\_SNK\_GET\_TYPEC\_CURRENT\_CAP}, &controlVal);
323             pdInstance->\hyperlink{struct__pd__instance_a519457e415e4eb39231c3e32316ffc83}{callbackFns}->\hyperlink{struct__pd__power__callback_a2a64b10db4e1644e17ee04e0a19cc412}{PD\_SnkDrawTypeCVbus}(pdInstance->
      \hyperlink{struct__pd__instance_a0eb7710a55cb5eb2a57355d772b26f74}{callbackParam}, controlVal, \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable});
324             \textcolor{keywordflow}{break};
325 
326 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_TRY\_SNK\_SUPPORT) && (PD\_CONFIG\_TRY\_SNK\_SUPPORT)}
327 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aba1f316befeaf678024cd17f6d359410}{TYPEC\_TRY\_SNK}:
328             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = 0;
329             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink};
330             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a935484922f134dd28059b0888fbd416e}{deviceType} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->
      \hyperlink{struct__pd__instance__config_a68e8aae835b95ae67d48701973864acf}{deviceType};
331             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
332             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
333             pdInstance->\hyperlink{struct__pd__instance_a88df7992251beb09fa2888f4ddf9766f}{trySNKState} = 0;
334             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fae9cc44d25a3e1f9c9272e8d3dba982d3}{tDRPTryTimer}, 
      \hyperlink{usb__pd__connect_8c_af30335a931e59303338047bc3f3f8e80}{T\_DRP\_TRY\_FOR\_TRY\_SNK});
335             \textcolor{keywordflow}{break};
336 \textcolor{preprocessor}{#endif}
337 \textcolor{preprocessor}{}
338         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1e60a88a2cd942ba4bd065ee2b9438d3}{TYPEC\_AUDIO\_ACCESSORY}:
339             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baaec27082d89b892747d115c26290da78f}{kTYPEC\_ConnectAudioAccessory}
      ;
340             controlVal = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
341             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadfcf4cb3c3f2b330b326278bac666a80}{PD\_PHY\_CONNECT\_SET\_CC}, &controlVal)
      ;
342 
343             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
344             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
345             \textcolor{comment}{/* Only apply termination and monitoring to CC1 */}
346             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = (\hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08dad8ccec791609837bd7b2cb928ba727b6}{kPD\_CC1});
347             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a9ba36d0a45cb600d503944f7edd5db7d}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
348             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
349 \textcolor{preprocessor}{#if AUDIO\_ACC\_DISCONNECT\_DEBOUNCE}
350 \textcolor{preprocessor}{}            \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\_CC\_DEBOUNCE});
351 \textcolor{preprocessor}{#endif}
352 \textcolor{preprocessor}{}            \textcolor{keywordflow}{break};
353 
354 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT)}
355 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a09376cb7ece9c3734d29379623b63a69}{TYPEC\_UNORIENTED\_DEBUG\_ACCESSORY\_SRC}:
356             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa2bfe3fb0aa9780231c7c87e8803bd591}{kTYPEC\_ConnectDebugAccessory}
      ;
357             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
358             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
359             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = (\hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid});
360             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a9ba36d0a45cb600d503944f7edd5db7d}{srcRpCurrent} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSrcCurrent;
361             \textcolor{keywordflow}{if} (\hyperlink{usb__pd__interface_8h_a447c32bfcfe6d47479635166462cfcd2}{PD\_CONFIG\_DEBUG\_ACCESSORY\_ROLE} == CONFIG\_DEBUG\_ACCESSORY\_DTS)
362             \{
363                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac94f35f2d29b440e1d4a221f693a877e}{debugDTS} = 1;
364                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_af1d9e713e2c0aa658d8b20bf641b82f8}{debugUnoriented} = 1;
365                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
366             \}
367             \textcolor{keywordflow}{else}
368             \{
369                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac94f35f2d29b440e1d4a221f693a877e}{debugDTS} = 0;
370                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_af1d9e713e2c0aa658d8b20bf641b82f8}{debugUnoriented} = 1;
371                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
372             \}
373             \textcolor{keywordflow}{break};
374 
375         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aa6be0b74b1649d54569a428ef0e326a4}{TYPEC\_ORIENTED\_DEBUG\_ACCESSORY\_SRC}:
376             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa2bfe3fb0aa9780231c7c87e8803bd591}{kTYPEC\_ConnectDebugAccessory}
      ;
377             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
378             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
379             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a9ba36d0a45cb600d503944f7edd5db7d}{srcRpCurrent} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSrcCurrent;
380             \textcolor{keywordflow}{if} (\hyperlink{usb__pd__interface_8h_a447c32bfcfe6d47479635166462cfcd2}{PD\_CONFIG\_DEBUG\_ACCESSORY\_ROLE} == CONFIG\_DEBUG\_ACCESSORY\_DTS)
381             \{
382                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac94f35f2d29b440e1d4a221f693a877e}{debugDTS} = 1;
383                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_af1d9e713e2c0aa658d8b20bf641b82f8}{debugUnoriented} = 0;
384                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
385             \}
386             \textcolor{keywordflow}{else}
387             \{
388                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac94f35f2d29b440e1d4a221f693a877e}{debugDTS} = 0;
389                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_af1d9e713e2c0aa658d8b20bf641b82f8}{debugUnoriented} = 0;
390                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
391             \}
392             \textcolor{keywordflow}{break};
393 
394         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abe78848b46b7ac825cdc24493593a500}{TYPEC\_DEBUG\_ACCESSORY\_SNK}:
395             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa2bfe3fb0aa9780231c7c87e8803bd591}{kTYPEC\_ConnectDebugAccessory}
      ;
396             \textcolor{keywordflow}{if} (\hyperlink{usb__pd__interface_8h_a447c32bfcfe6d47479635166462cfcd2}{PD\_CONFIG\_DEBUG\_ACCESSORY\_ROLE} == CONFIG\_DEBUG\_ACCESSORY\_DTS)
397             \{
398                 \textcolor{comment}{/* The DTS controls the orientation */}
399                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink};
400                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
401                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = (\hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid});
402                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac94f35f2d29b440e1d4a221f693a877e}{debugDTS} = 1;
403                 detachDetecParam.\hyperlink{struct__pd__detach__detection__param_af1d9e713e2c0aa658d8b20bf641b82f8}{debugUnoriented} = 1;
404                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
405             \}
406             \textcolor{comment}{/* Wait PDDebounce before checking orientation */}
407             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\_PD\_DEBOUNCE});
408             writeRegsNeeded = 0;
409             \textcolor{keywordflow}{break};
410 \textcolor{preprocessor}{#endif}
411 \textcolor{preprocessor}{}
412 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT)}
413 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a33dafd4e9c965a76d5bb1ac199374a5d}{TYPEC\_UNSUPPORTED\_ACCESSORY}:
414             \textcolor{comment}{/* Only one of the CC1 or CC2 pins shall be in the SRC.Rd state. The port shall advertise
       Default}
415 \textcolor{comment}{               USB Power (see Table 4-15) on this CC pin and monitor its voltage. */}
416             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = 
      \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baabe52f1d315591ba1128796fe989888b6}{kTYPEC\_ConnectVconnPoweredAccessory};
417             controlVal = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
418             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadfcf4cb3c3f2b330b326278bac666a80}{PD\_PHY\_CONNECT\_SET\_CC}, &controlVal)
      ;
419 
420             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
421             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
422             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed};
423             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a9ba36d0a45cb600d503944f7edd5db7d}{srcRpCurrent} = \hyperlink{group__usb__pd__stack_ggaf956bb4d3d27df52fb694311b8219b0ea763adf3048e338ea883604ec91ea732b}{kCurrent\_StdUSB};
424             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
425             \textcolor{keywordflow}{break};
426 
427         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aa63e0f23c29eb4b994ef8aa3aa6a3e11}{TYPEC\_ATTACH\_WAIT\_ACCESSORY}:
428             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\_CC\_DEBOUNCE});
429             \textcolor{keywordflow}{break};
430 
431         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a52743b32e531cf3605d534ae3d2bf014}{TYPEC\_POWERED\_ACCESSORY}:
432             \textcolor{comment}{/* When in the PoweredAccessory state, the port is powering a VCONN-powered Accessory. */}
433             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa30444778033546172c76622995ada281}{tAMETimeoutTimer}, 
      \hyperlink{usb__pd__timer_8h_ac7da483b951347f964a3a96309855eb7}{T\_AME\_TIMEOUT});
434 
435             pdInstance->\hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState} = \hyperlink{group__usb__pd__stack_gga5dcf4d70a373001cfde169f0e8b9a1baa18eca9dd0eea417e318901214fabeab2}{kTYPEC\_ConnectSource};
436             controlVal = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
437             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadfcf4cb3c3f2b330b326278bac666a80}{PD\_PHY\_CONNECT\_SET\_CC}, &controlVal)
      ;
438 
439             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a83d3118f26d1bd19d41aa61885fec230}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
440             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a3972d78d7c87afef1c5d732aca07cacc}{typecConnectState} = pdInstance->
      \hyperlink{struct__pd__instance_a4f8aff7c9d2b914a5be9f0bd297c197c}{connectState};
441             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_ac0e0e85417ccfdbec7069854ca6a24d6}{usedCC} = (pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed});
442             detachDetecParam.\hyperlink{struct__pd__detach__detection__param_a9ba36d0a45cb600d503944f7edd5db7d}{srcRpCurrent} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSrcCurrent;
443             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda05e43d8ecefa1b3d13bb81cb3badf466}{PD\_PHY\_CONFIG\_DETACH\_DETECTION}, &detachDetecParam);
444 
445             vconn\_en = VCONN\_FORCE\_ON;
446             \textcolor{keywordflow}{break};
447 \textcolor{preprocessor}{#endif}
448 \textcolor{preprocessor}{}
449 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_TRY\_SRC\_SUPPORT) && (PD\_CONFIG\_TRY\_SRC\_SUPPORT)}
450 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a4f775507f441bbd5fdd9b7af5a501f95}{TYPEC\_TRY\_SRC}:
451             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = 0;
452             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
453             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
454             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
455             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fae9cc44d25a3e1f9c9272e8d3dba982d3}{tDRPTryTimer}, 
      \hyperlink{usb__pd__connect_8c_a61940c99c3548678de15e41bbce15ad1}{T\_DRP\_TRY});
456             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\_PD\_DEBOUNCE});
457             \textcolor{keywordflow}{break};
458 \textcolor{preprocessor}{#endif}
459 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if (defined PD\_CONFIG\_TRY\_SNK\_SUPPORT) && (PD\_CONFIG\_TRY\_SNK\_SUPPORT)}
460 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a65cf90e3e7bca7d27c2c0ae6957edf0d}{TYPEC\_TRY\_WAIT\_SRC}:
461             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = 0;
462             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8ba9fdae65ce89c7d877981a3abef33a2cb}{kPD\_PowerRoleSource};
463             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a935484922f134dd28059b0888fbd416e}{deviceType} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->
      \hyperlink{struct__pd__instance__config_a68e8aae835b95ae67d48701973864acf}{deviceType};
464             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
465             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
466             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fae9cc44d25a3e1f9c9272e8d3dba982d3}{tDRPTryTimer}, 
      \hyperlink{usb__pd__connect_8c_a61940c99c3548678de15e41bbce15ad1}{T\_DRP\_TRY});
467             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\_PD\_DEBOUNCE});
468             \textcolor{keywordflow}{break};
469 \textcolor{preprocessor}{#endif}
470 \textcolor{preprocessor}{}
471 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_TRY\_SRC\_SUPPORT) && (PD\_CONFIG\_TRY\_SRC\_SUPPORT)}
472 \textcolor{preprocessor}{}        \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a2b1c7d8d21f96cfad356308863269872}{TYPEC\_TRY\_WAIT\_SNK}:
473             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_aa28f1c14440b918b0e10ed04c7483095}{isDRP} = 0;
474             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a004647edd5c7e75ce9bd0cc218caf8b1}{powerRole} = \hyperlink{group__usb__pd__stack_gga46146487374ddc31d48f33b2b6a26f8bafca465150c227ef579c7a2bfc47b4072}{kPD\_PowerRoleSink};
475             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a935484922f134dd28059b0888fbd416e}{deviceType} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->
      \hyperlink{struct__pd__instance__config_a68e8aae835b95ae67d48701973864acf}{deviceType};
476             attachDetecParam.\hyperlink{struct__pd__attach__detection__param_a9745c17522adaa5e1e8372df1a57f233}{srcRpCurrent} = pdInstance->
      \hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aaec71cee54cf853e332a4b4ed1ef17ae}{typecSrcCurrent};
477             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, 
      \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda229dbc5fbb6944903d1627a413aa76fe}{PD\_PHY\_CONFIG\_ATTACH\_DETECTION}, &attachDetecParam);
478             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\_PD\_DEBOUNCE});
479             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\_CC\_DEBOUNCE});
480             \textcolor{keywordflow}{break};
481 \textcolor{preprocessor}{#endif}
482 \textcolor{preprocessor}{}
483         \textcolor{keywordflow}{default}:
484             writeRegsNeeded = 0;
485             \textcolor{keywordflow}{break};
486     \}
487 
488     \textcolor{comment}{/* common process */}
489     \textcolor{keywordflow}{switch} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState})
490     \{
491         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abbb8f217eb3a1e48e8801810e67c94b6}{TYPEC\_ERROR\_RECOVERY}:
492         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ae804ea52cb577a1087ceedc86d227285}{TYPEC\_DISABLED}:
493         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC}:
494         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK}:
495         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a48a06d065d2a479f3ad3baf0786e954f}{TYPEC\_UNATTACHED\_ACCESSORY}:
496         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a2b1c7d8d21f96cfad356308863269872}{TYPEC\_TRY\_WAIT\_SNK}:
497         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aba1f316befeaf678024cd17f6d359410}{TYPEC\_TRY\_SNK}:
498         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a4f775507f441bbd5fdd9b7af5a501f95}{TYPEC\_TRY\_SRC}:
499         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a65cf90e3e7bca7d27c2c0ae6957edf0d}{TYPEC\_TRY\_WAIT\_SRC}:
500         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338af63a615d3eb1e5a83c087437209c81b9}{TYPEC\_TOGGLE\_SRC\_FIRST}:
501         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST}:
502             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
503 
504             \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} == 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge})
505             \{
506                 controlVal = 1;
507                 pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa7db50d892d990fc709cc55893912a229}{kVbus\_TypecDischarge};
508                 pdInstance->\hyperlink{struct__pd__instance_a519457e415e4eb39231c3e32316ffc83}{callbackFns}->\hyperlink{struct__pd__power__callback_a1afed4126bcbe1ba278eb27f31e99c9c}{PD\_SrcTurnOffVbus}(pdInstance->
      \hyperlink{struct__pd__instance_a0eb7710a55cb5eb2a57355d772b26f74}{callbackParam}, \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable});
509                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edae705da68d4de3104b6852d84715bb71b}{PD\_PHY\_DISCHARGE\_VBUS}, &
      controlVal);
510 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_MIN\_DISCHARGE\_TIME\_ENABLE) && (PD\_CONFIG\_MIN\_DISCHARGE\_TIME\_ENABLE)}
511 \textcolor{preprocessor}{}                \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fae1e72be49d715105618c5266d8348b7d}{tTypeCVbusMinDischargeTimer}, \hyperlink{usb__pd__timer_8h_a290959f551e6b12818c09607ff90e9b4}{T\_MIN\_VBUS\_DISCHARGE});
512 \textcolor{preprocessor}{#else}
513 \textcolor{preprocessor}{}                \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa5d99688807a9cf008b7087f068dcee44}{tTypeCVbusMaxDischargeTimer}, \hyperlink{usb__pd__timer_8h_a32e20656b2cbd8812656a7f1e3f917f0}{T\_MAX\_VBUS\_DISCHARGE});
514 \textcolor{preprocessor}{#endif}
515 \textcolor{preprocessor}{}            \}
516             \textcolor{comment}{/* HalVbusDisableMonitorAndDetect must be excuted after HalResetFetControl (discharge)
       operation */}
517             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda12e5c95c04532128d54f63e4e76d2c6e}{PD\_PHY\_RESET\_MSG\_FUNCTION}, NULL
      );
518             \textcolor{keywordflow}{break};
519 
520         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC}:
521         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK}:
522             \textcolor{keywordflow}{break};
523 
524         \textcolor{keywordflow}{default}:
525             \textcolor{comment}{/* Ensure discharge does not continue across state change. */}
526             \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} != 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{kVbus\_NoDischarge})
527             \{
528                 pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{kVbus\_NoDischarge};
529                 controlVal = 0;
530                 \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edae705da68d4de3104b6852d84715bb71b}{PD\_PHY\_DISCHARGE\_VBUS}, &
      controlVal);
531             \}
532             \textcolor{keywordflow}{break};
533     \}
534 
535     \textcolor{comment}{//设置cc monitor的参数，根据cc的使用情况，设置CCxMonitor变量}
536     \hyperlink{usb__pd__connect_8c_a0328bd52ba61da793f163660077a0076}{PD\_ConnectSetMonitorCC}(pdInstance);
537 
538     \textcolor{comment}{//上面的switch case中根据需求设置writeRegsNeeded和相关的变量，在最后如果writeRegsNeeded为1}
539     \textcolor{comment}{//则表示需要写phy register}
540     \textcolor{keywordflow}{if} (writeRegsNeeded)
541     \{
542         \textcolor{comment}{//如果当前不是attached状态}
543         \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} != \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC}) && (
      pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} != \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK}))
544         \{
545             controlVal = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
546             \textcolor{comment}{// Question: disable cc? why?}
547             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadfcf4cb3c3f2b330b326278bac666a80}{PD\_PHY\_CONNECT\_SET\_CC}, &controlVal)
      ;
548         \}
549 
550         \textcolor{comment}{//设置vconn}
551         \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_aa552a27c5747ea789ad185fefac44194}{vconnSupported}) && (vconn\_en != 
      VCONN\_NO\_CHANGE))
552         \{
553             controlVal = (vconn\_en == VCONN\_FORCE\_ON);
554             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda68ad1faa15b73743adf7f5a58013937b}{PD\_PHY\_CONTROL\_VCONN}, &controlVal);
555         \}
556 
557 \textcolor{preprocessor}{#if (PD\_CONFIG\_OLD\_INTERFACE)}
558 \textcolor{preprocessor}{}        \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, PD\_PHY\_CONNECT\_CONTROL\_FLUSH, NULL);
559 \textcolor{preprocessor}{#endif}
560 \textcolor{preprocessor}{}    \}
561 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_ab61b3d8329ec92553e670b6b0997fa81}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State@{P\-D\-\_\-\-Connect\-State}}
\index{P\-D\-\_\-\-Connect\-State@{P\-D\-\_\-\-Connect\-State}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State}]{\setlength{\rightskip}{0pt plus 5cm}static uint8\-\_\-t P\-D\-\_\-\-Connect\-State (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_ab61b3d8329ec92553e670b6b0997fa81}

\begin{DoxyCode}
1408 \{
1409     \textcolor{keywordflow}{switch} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState})
1410     \{
1411         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC}:
1412         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK}:
1413         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1e60a88a2cd942ba4bd065ee2b9438d3}{TYPEC\_AUDIO\_ACCESSORY}:
1414         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a52743b32e531cf3605d534ae3d2bf014}{TYPEC\_POWERED\_ACCESSORY}:
1415         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a33dafd4e9c965a76d5bb1ac199374a5d}{TYPEC\_UNSUPPORTED\_ACCESSORY}:
1416         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a09376cb7ece9c3734d29379623b63a69}{TYPEC\_UNORIENTED\_DEBUG\_ACCESSORY\_SRC}:
1417         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aa6be0b74b1649d54569a428ef0e326a4}{TYPEC\_ORIENTED\_DEBUG\_ACCESSORY\_SRC}:
1418         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abe78848b46b7ac825cdc24493593a500}{TYPEC\_DEBUG\_ACCESSORY\_SNK}:
1419             \textcolor{keywordflow}{return} \hyperlink{usb__pd__interface_8h_a924ee365c422092460915bc8cd8b9cbba56560172992b012a9e3ea7a47885bd40}{kConnectState\_Connected};
1420 
1421         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a4f775507f441bbd5fdd9b7af5a501f95}{TYPEC\_TRY\_SRC}:
1422         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a2b1c7d8d21f96cfad356308863269872}{TYPEC\_TRY\_WAIT\_SNK}:
1423         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aba1f316befeaf678024cd17f6d359410}{TYPEC\_TRY\_SNK}:
1424         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a65cf90e3e7bca7d27c2c0ae6957edf0d}{TYPEC\_TRY\_WAIT\_SRC}:
1425         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC}:
1426         \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK}:
1427             \textcolor{keywordflow}{return} \hyperlink{usb__pd__interface_8h_a924ee365c422092460915bc8cd8b9cbba4e1bf59f2d40fb235c0afed35f455701}{kConnectState\_NotStable};
1428 
1429         \textcolor{keywordflow}{default}:
1430             \textcolor{keywordflow}{return} \hyperlink{usb__pd__interface_8h_a924ee365c422092460915bc8cd8b9cbbaea13843a3c8cfb639d76fc9a4e387b53}{kConnectState\_Disconnected};
1431     \}
1432 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ab61b3d8329ec92553e670b6b0997fa81_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a4cb64b10c04da73729388d11be51338e}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process@{P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process@{P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Drp\-Toggle\-Src\-Or\-Snk\-First\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a4cb64b10c04da73729388d11be51338e}

\begin{DoxyCode}
988 \{
989     uint8\_t preState = pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState};
990     \textcolor{comment}{/* looking for looking 4 connection */}
991     \textcolor{comment}{/* note: TCPC will stop toggling when some bogus(伪造的) connection are found, TCPM will transit to
       attach\_wait status and}
992 \textcolor{comment}{     */}
993     \textcolor{comment}{/* use cc\_debounce to filter these bogus connection */}
994     \textcolor{comment}{/* If the connection is bogus, TCPM will transit back to TYPEC\_TOGGLE\_SRC\_FIRST/TYPEC\_TOGGLE\_SNK\_FIRST
       and restart}
995 \textcolor{comment}{     */}
996     \textcolor{comment}{/* DRP toggling */}
997     \textcolor{comment}{// as source, detect Rd or Ra }
998     \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) || (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) ||
999         ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa})))
1000     \{
1001         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC};
1002     \}
1003     \textcolor{comment}{// as sink, detect Rp}
1004     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) || (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}))
1005     \{
1006         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK};
1007     \}
1008     \textcolor{keywordflow}{else}
1009     \{
1010     \}
1011 
1012     \textcolor{comment}{// work around}
1013 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_COMPLIANCE\_TEST\_ENABLE) && (PD\_CONFIG\_COMPLIANCE\_TEST\_ENABLE)}
1014 \textcolor{preprocessor}{}    \textcolor{comment}{/* If the TCPC has incorrectly entered AttachWait.SRC with VBus not at VSafe0V, */}
1015     \textcolor{comment}{/* then move to Unattached.SRC instead. */}
1016     \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC}))
1017     \{
1018         uint32\_t infoVal;
1019         \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &
      infoVal);
1020         \textcolor{keywordflow}{if} (!(infoVal & \hyperlink{group__usb__pd__phy__drv_gabf05bb09647628f3556c817e1f059175}{PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK}))
1021         \{
1022             pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge};
1023             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
1024         \}
1025     \}
1026 \textcolor{preprocessor}{#endif}
1027 \textcolor{preprocessor}{}
1028     \textcolor{comment}{/* error process */}
1029     \textcolor{comment}{/* if right, the cc state should be kCCState\_Unknown/kCCState\_Unstable}
1030 \textcolor{comment}{           because the look4connection is going-on */}
1031     \textcolor{keywordflow}{if} ((preState == pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState}) && ((
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen} == cc1State) || (\hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen} == cc2State)))
1032     \{
1033         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a46b9d34b21328c188c161825bf8e8217}{rdRpErrorCount} > 5)
1034         \{
1035             \hyperlink{struct__pd__phy__config}{pd\_phy\_config\_t} phyConfig;
1036 
1037             pdInstance->\hyperlink{struct__pd__instance_abb01fbdcfbc66eba6c7d5d85e91e62e4}{noConnectButVBusExit} = 0;
1038             pdInstance->\hyperlink{struct__pd__instance_adbed7b2cd53df40e0611a8879c903339}{phyInterface}->\hyperlink{struct__pd__phy__api__interface_a9e36ebe547c2ed82866597b2afc54bd0}{pdPhyDeinit}(pdInstance->
      \hyperlink{struct__pd__instance_a7c1184292efe9a5ae30b6ac422c1e9f4}{pdPhyHandle});
1039             phyConfig.\hyperlink{struct__pd__phy__config_aa5aa79cabb041cefecc0483c840f75a1}{interface} = pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->
      \hyperlink{struct__pd__instance__config_acb93f9cec67a95c40730be43c80d3214}{phyInterface};
1040             phyConfig.\hyperlink{struct__pd__phy__config_aa606732850969dd6c9bd06b608e8015c}{i2cConfig}.\hyperlink{struct__pd__i2c__interface__config_abef5bc903024c7f0c489407549948987}{slaveAddress} = pdInstance->
      \hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->\hyperlink{struct__pd__instance__config_a7e72c5dda8b81981ebd3062f6999bce1}{interfaceParam};
1041             pdInstance->\hyperlink{struct__pd__instance_adbed7b2cd53df40e0611a8879c903339}{phyInterface}->\hyperlink{struct__pd__phy__api__interface_a8f9666a7543d431aec266710dbc8d78c}{pdPhyInit}(pdInstance, &(pdInstance->
      \hyperlink{struct__pd__instance_a7c1184292efe9a5ae30b6ac422c1e9f4}{pdPhyHandle}), &phyConfig);
1042             pdInstance->\hyperlink{struct__pd__instance_a46b9d34b21328c188c161825bf8e8217}{rdRpErrorCount} = 0;
1043         \}
1044         \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
1045         pdInstance->\hyperlink{struct__pd__instance_a46b9d34b21328c188c161825bf8e8217}{rdRpErrorCount}++;
1046     \}
1047     \textcolor{keywordflow}{else}
1048     \{
1049         pdInstance->\hyperlink{struct__pd__instance_a46b9d34b21328c188c161825bf8e8217}{rdRpErrorCount} = 0;
1050     \}
1051 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a4cb64b10c04da73729388d11be51338e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a4cb64b10c04da73729388d11be51338e_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a6147b33e99b7812c8de585d73af2f2c4}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Machine@{P\-D\-\_\-\-Connect\-State\-Machine}}
\index{P\-D\-\_\-\-Connect\-State\-Machine@{P\-D\-\_\-\-Connect\-State\-Machine}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Machine}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Type\-C\-State\-\_\-t} P\-D\-\_\-\-Connect\-State\-Machine (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a6147b33e99b7812c8de585d73af2f2c4}

\begin{DoxyCode}
1435 \{
1436     uint8\_t preState;
1437     uint32\_t infoVal;
1438 
1439     \hyperlink{group__usb__pd__phy__drv_ga33106675227396a51d78ea6a7f562570}{pd\_phy\_cc\_state\_t} cc1State;
1440     \hyperlink{group__usb__pd__phy__drv_ga33106675227396a51d78ea6a7f562570}{pd\_phy\_cc\_state\_t} cc2State;
1441     \hyperlink{struct__pd__phy__get__cc__state}{pd\_phy\_get\_cc\_state\_t} ccState;
1442 
1443     \textcolor{comment}{/* This loop will repeat while the state is changed */}
1444     \textcolor{keywordflow}{while} (1)
1445     \{
1446         \textcolor{comment}{// 根据phy role control and cc status 设置ccState}
1447         \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edae5f03a153f98ececc88b52f551f55c2e}{PD\_PHY\_GET\_CC\_LINE\_STATE}, &ccState);
1448         cc1State = (\hyperlink{group__usb__pd__phy__drv_ga33106675227396a51d78ea6a7f562570}{pd\_phy\_cc\_state\_t})ccState.\hyperlink{struct__pd__phy__get__cc__state_a551804e47b7f897e9e4ca61e0af9caf3}{cc1State};
1449         cc2State = (\hyperlink{group__usb__pd__phy__drv_ga33106675227396a51d78ea6a7f562570}{pd\_phy\_cc\_state\_t})ccState.\hyperlink{struct__pd__phy__get__cc__state_af32a14cc7bbfad052b927f765176aac8}{cc2State};
1450 
1451         preState = pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState};
1452         \textcolor{keywordflow}{switch} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState})
1453         \{
1454             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338af63a615d3eb1e5a83c087437209c81b9}{TYPEC\_TOGGLE\_SRC\_FIRST}:
1455             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST}:
1456                 \hyperlink{usb__pd__connect_8c_a4cb64b10c04da73729388d11be51338e}{PD\_ConnectStateDrpToggleSrcOrSnkFirstProcess}(
      pdInstance, cc1State, cc2State);
1457                 \textcolor{keywordflow}{break};
1458 
1459             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC}:
1460                 \hyperlink{usb__pd__connect_8c_af6d40e216e9c36436e8363ff28113a3a}{PD\_ConnectStateSrcUnattachedSrcProcess}(pdInstance, 
      cc1State, cc2State);
1461                 \textcolor{keywordflow}{break};
1462 
1463             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC}:
1464                 \hyperlink{usb__pd__connect_8c_a6313417f32370723f208ee8129f7348b}{PD\_ConnectStateSrcAttachWaitSrcProcess}(pdInstance, 
      cc1State, cc2State);
1465                 \textcolor{keywordflow}{break};
1466 
1467             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC}:
1468                 \hyperlink{usb__pd__connect_8c_a3941fedd707bcdc334532b184d27787f}{PD\_ConnectStateSrcAttachedSrcProcess}(pdInstance, 
      cc1State, cc2State);
1469                 \textcolor{keywordflow}{break};
1470 
1471             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK}:
1472                 \hyperlink{usb__pd__connect_8c_ae84ce27d88537e1fb4335d7cb8a304a5}{PD\_ConnectStateSnkUnattachedSnkProcess}(pdInstance, 
      cc1State, cc2State);
1473                 \textcolor{keywordflow}{break};
1474 
1475             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK}:
1476                 \hyperlink{usb__pd__connect_8c_ad9e61e9e67e7d53a66151eae69b658d8}{PD\_ConnectStateSnkAttachWaitSnkProcess}(pdInstance, 
      cc1State, cc2State);
1477                 \textcolor{keywordflow}{break};
1478 
1479             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK}:
1480                 \hyperlink{usb__pd__connect_8c_a0144954fa9035cc4e57c20a6a32713c8}{PD\_ConnectStateSnkAttachedSnkProcess}(pdInstance, 
      cc1State, cc2State);
1481                 \textcolor{keywordflow}{break};
1482 
1483 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_AUDIO\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_AUDIO\_ACCESSORY\_SUPPORT)}
1484 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1e60a88a2cd942ba4bd065ee2b9438d3}{TYPEC\_AUDIO\_ACCESSORY}:
1485                 PD\_ConnectStateSrcAudioAccessoryProcess(pdInstance, cc1State, cc2State);
1486                 \textcolor{keywordflow}{break};
1487 \textcolor{preprocessor}{#endif}
1488 \textcolor{preprocessor}{}
1489 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT)}
1490 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a09376cb7ece9c3734d29379623b63a69}{TYPEC\_UNORIENTED\_DEBUG\_ACCESSORY\_SRC}:
1491                 PD\_ConnectStateSrcUnorientedDebugAccSrcProcess(pdInstance, cc1State, cc2State);
1492                 \textcolor{keywordflow}{break};
1493 
1494             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aa6be0b74b1649d54569a428ef0e326a4}{TYPEC\_ORIENTED\_DEBUG\_ACCESSORY\_SRC}:
1495                 PD\_ConnectStateSrcOrientedDebugAccSrcProcess(pdInstance, cc1State, cc2State);
1496                 \textcolor{keywordflow}{break};
1497 
1498             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abe78848b46b7ac825cdc24493593a500}{TYPEC\_DEBUG\_ACCESSORY\_SNK}:
1499                 PD\_ConnectStateSnkDebugAccSnkProcess(pdInstance, cc1State, cc2State);
1500                 \textcolor{keywordflow}{break};
1501 \textcolor{preprocessor}{#endif}
1502 \textcolor{preprocessor}{}
1503 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_TRY\_SNK\_SUPPORT) && (PD\_CONFIG\_TRY\_SNK\_SUPPORT)}
1504 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aba1f316befeaf678024cd17f6d359410}{TYPEC\_TRY\_SNK}:
1505                 PD\_ConnectStateSrcTrySnkProcess(pdInstance, cc1State, cc2State);
1506                 \textcolor{keywordflow}{break};
1507 
1508             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a65cf90e3e7bca7d27c2c0ae6957edf0d}{TYPEC\_TRY\_WAIT\_SRC}:
1509                 PD\_ConnectStateSrcTryWaitSrcProcess(pdInstance, cc1State, cc2State);
1510                 \textcolor{keywordflow}{break};
1511 \textcolor{preprocessor}{#endif}
1512 \textcolor{preprocessor}{}
1513 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_TRY\_SRC\_SUPPORT) && (PD\_CONFIG\_TRY\_SRC\_SUPPORT)}
1514 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a4f775507f441bbd5fdd9b7af5a501f95}{TYPEC\_TRY\_SRC}:
1515                 PD\_ConnectStateSnkTrySrcProcess(pdInstance, cc1State, cc2State);
1516                 \textcolor{keywordflow}{break};
1517 
1518             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a2b1c7d8d21f96cfad356308863269872}{TYPEC\_TRY\_WAIT\_SNK}:
1519                 PD\_ConnectStateSnkTryWaitSnkProcess(pdInstance, cc1State, cc2State);
1520                 \textcolor{keywordflow}{break};
1521 \textcolor{preprocessor}{#endif}
1522 \textcolor{preprocessor}{}
1523 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT)}
1524 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a48a06d065d2a479f3ad3baf0786e954f}{TYPEC\_UNATTACHED\_ACCESSORY}:
1525                 PD\_ConnectStateSnkUnattachedAccessory(pdInstance, cc1State, cc2State);
1526                 \textcolor{keywordflow}{break};
1527 
1528             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aa63e0f23c29eb4b994ef8aa3aa6a3e11}{TYPEC\_ATTACH\_WAIT\_ACCESSORY}:
1529                 PD\_ConnectStateSnkAttachWaitAccessoryProcess(pdInstance, cc1State, cc2State);
1530                 \textcolor{keywordflow}{break};
1531 
1532             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a52743b32e531cf3605d534ae3d2bf014}{TYPEC\_POWERED\_ACCESSORY}:
1533                 PD\_ConnectStateSnkPoweredAccessoryProcess(pdInstance, cc1State, cc2State);
1534                 \textcolor{keywordflow}{break};
1535 
1536             \textcolor{keywordflow}{case} \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a33dafd4e9c965a76d5bb1ac199374a5d}{TYPEC\_UNSUPPORTED\_ACCESSORY}:
1537                 PD\_ConnectStateSrcUnsupportedAccProcess(pdInstance, cc1State, cc2State);
1538                 \textcolor{keywordflow}{break};
1539 \textcolor{preprocessor}{#endif}
1540 \textcolor{preprocessor}{}
1541             \textcolor{keywordflow}{default}:
1542                 \textcolor{keywordflow}{break};
1543         \}
1544 
1545         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} == 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa7db50d892d990fc709cc55893912a229}{kVbus\_TypecDischarge})
1546         \{
1547             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, 
      &infoVal);
1548             \textcolor{keywordflow}{if} (
1549 #\textcolor{keywordflow}{if} (defined \hyperlink{usb__pd__config_8h_af713fdd823151fddb0577f3756deac17}{PD\_CONFIG\_MIN\_DISCHARGE\_TIME\_ENABLE}) && (
      PD\_CONFIG\_MIN\_DISCHARGE\_TIME\_ENABLE)
1550                 \hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fae1e72be49d715105618c5266d8348b7d}{tTypeCVbusMinDischargeTimer}) &&
1551                 (infoVal & \hyperlink{group__usb__pd__phy__drv_gabf05bb09647628f3556c817e1f059175}{PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK})
1552 #\textcolor{keywordflow}{else}
1553                 (infoVal & PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK)
1554 #endif
1555                     )
1556             \{
1557                 pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{kVbus\_NoDischarge};
1558                 \hyperlink{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa}{PD\_DpmDischargeVbus}(pdInstance, 0);
1559                 \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa5d99688807a9cf008b7087f068dcee44}{tTypeCVbusMaxDischargeTimer});
1560                 \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fae1e72be49d715105618c5266d8348b7d}{tTypeCVbusMinDischargeTimer});
1561             \}
1562             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa5d99688807a9cf008b7087f068dcee44}{tTypeCVbusMaxDischargeTimer}))
1563             \{
1564                 pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afa5b700ae7ca999552a849bb914cb0b08c}{kVbus\_NoDischarge};
1565                 \hyperlink{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa}{PD\_DpmDischargeVbus}(pdInstance, 0);
1566             \}
1567         \}
1568 
1569         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} != preState)
1570         \{
1571             \textcolor{keywordflow}{if} (cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa})
1572             \{
1573                 pdInstance->\hyperlink{struct__pd__instance_a5905690cc5a12a0758be0574d4bc262e}{raPresent} = 1;
1574             \}
1575             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (cc2State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa})
1576             \{
1577                 pdInstance->\hyperlink{struct__pd__instance_a5905690cc5a12a0758be0574d4bc262e}{raPresent} = 2;
1578             \}
1579             \textcolor{keywordflow}{else}
1580             \{
1581             \}
1582             \hyperlink{group__usb__os__abstraction_gaa83073c31cced5742027d4046bd633db}{USB\_OsaEventSet}(pdInstance->\hyperlink{struct__pd__instance_ab04e9fcc994b2547509169e07ab21465}{taskEventHandle}, 
      \hyperlink{usb__pd__interface_8h_a08a5013301d9587b47017854a2ee5981acf345f0b57466940ab6b574ee9c3c2bc}{PD\_TASK\_EVENT\_OTHER});
1583             \hyperlink{usb__pd__connect_8c_a0608faf2438b33700fc4680061ae69ab}{PD\_ConnectSetupNewState}(pdInstance, 0);
1584         \}
1585         \textcolor{keywordflow}{return} pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState};
1586     \}
1587 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a6147b33e99b7812c8de585d73af2f2c4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a6147b33e99b7812c8de585d73af2f2c4_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a0144954fa9035cc4e57c20a6a32713c8}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process@{P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process@{P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Snk\-Attached\-Snk\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a0144954fa9035cc4e57c20a6a32713c8}

\begin{DoxyCode}
1291 \{
1292     uint32\_t infoVal;
1293     \textcolor{comment}{/* A port that is not in the process of a USB PD PR\_Swap or a USB PD Hard Reset shall transition}
1294 \textcolor{comment}{    to Unattached.SNK when VBUS falls below 3.67 V. Note if VBUS has been adjusted by USB PD}
1295 \textcolor{comment}{    to operate above 5 V, then the port shall transition to Unattached.SNK when VBUS falls below}
1296 \textcolor{comment}{    80% of the negotiated value. If supplying VCONN, the port shall cease to supply it within}
1297 \textcolor{comment}{    tVCONNOFF of exiting Attached.SNK. */}
1298 
1299     \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &infoVal
      );
1300     infoVal = ((infoVal & \hyperlink{group__usb__pd__phy__drv_ga1f2e4aed47a47caec2aba9edb2236e42}{PD\_VBUS\_POWER\_STATE\_VSAFE5V\_MASK}) || (infoVal & 
      \hyperlink{group__usb__pd__phy__drv_gabe6758409c7aeff91de688fe7cefa195}{PD\_VBUS\_POWER\_STATE\_VBUS\_MASK}));
1301     \textcolor{keywordflow}{if} (
1302 #\textcolor{keywordflow}{if} (\hyperlink{usb__pd__config_8h_a6c7fdd8725deeb9b9fde706e9413f7cf}{PD\_CONFIG\_SINK\_DETACH\_DETECT\_WAY} == 
      \hyperlink{battery_2usb__pd__config_8h_a26ae67c195a653e3fa00d94551e85381}{PD\_SINK\_DETACH\_ON\_VBUS\_ABSENT})
1303         ((!(infoVal)) && (pdInstance->\hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} == \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badc5ad96f1d56cc3354757de9aea78896}{kVbusPower\_Stable})) ||
1304         ((pdInstance->\hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} == \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771ba08bcf27d29365689235f1a3f6b683a09}{kVbusPower\_InHardReset}) && (!(infoVal))
       && (cc1State != \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) &&
1305          (cc2State != \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp})) ||
1306 \textcolor{preprocessor}{#endif}
1307 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if (PD\_CONFIG\_SINK\_DETACH\_DETECT\_WAY == PD\_SINK\_DETACH\_ON\_CC\_OPEN)}
1308 \textcolor{preprocessor}{}        \textcolor{comment}{// Refer to "USB Type-C ECR Exit\_from\_Attached.SNK\_state.doc"}
1309         \textcolor{comment}{// The *\_detect values are debounced with tPDDebounce}
1310         \textcolor{comment}{// %%% Need to also exclude fast role swap in progress %%%}
1311         ((pdInstance->\hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} != \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badfb60998cac82d001b52af44674eef18}{kVbusPower\_InFRSwap}) &&
1312          (((pdInstance->\hyperlink{struct__pd__instance_ae190e16d15f42371ac82937f08371c98}{cc1Monitor}) && (cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaa72b993ea12153a2594e24883bf82250e}{kCCState\_SnkOpen})) ||
1313           ((pdInstance->\hyperlink{struct__pd__instance_af6e379f0550864c814e92c07732b6ea9}{cc2Monitor}) && (cc2State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaa72b993ea12153a2594e24883bf82250e}{kCCState\_SnkOpen})))) ||
1314 #endif
1315         0)
1316     \{
1317         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK};
1318         pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge};
1319     \}
1320 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a0144954fa9035cc4e57c20a6a32713c8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a0144954fa9035cc4e57c20a6a32713c8_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_ad9e61e9e67e7d53a66151eae69b658d8}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process@{P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process@{P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Snk\-Attach\-Wait\-Snk\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_ad9e61e9e67e7d53a66151eae69b658d8}

\begin{DoxyCode}
1084 \{
1085     uint32\_t infoVal;
1086     uint8\_t vbusPresent = 0;
1087 
1088     \textcolor{comment}{/* all open */}
1089     \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaa72b993ea12153a2594e24883bf82250e}{kCCState\_SnkOpen}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaa72b993ea12153a2594e24883bf82250e}{kCCState\_SnkOpen}))
1090     \{
1091         \textcolor{comment}{/* restart the attach detection timer */}
1092         \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a60b5dc12e006426f4f934281a330b1dc}{T\_CC\_DEBOUNCE});
1093 
1094         \textcolor{comment}{/* A Sink shall transition to Unattached.SNK when the state of both the CC1 and CC2 pins is}
1095 \textcolor{comment}{           SNK.Open for at least tPDDebounce.}
1096 \textcolor{comment}{           A DRP shall transition to Unattached.SRC when the state of both the CC1 and CC2 pins is}
1097 \textcolor{comment}{           SNK.Open for at least tPDDebounce. */}
1098         \textcolor{keywordflow}{if} (\hyperlink{usb__pd__timer_8c_a3d4072fbbc7b10a05c795eaf9ed33f5f}{PD\_TimerCheckInvalidOrTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}))
1099         \{
1100             \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling})
1101             \{
1102                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338af63a615d3eb1e5a83c087437209c81b9}{TYPEC\_TOGGLE\_SRC\_FIRST};
1103             \}
1104             \textcolor{keywordflow}{else}
1105             \{
1106                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a98e3fb19049ca9cde6495dd9f803e1bf}{TYPEC\_UNATTACHED\_SNK};
1107             \}
1108         \}
1109     \}
1110     \textcolor{keywordflow}{else}
1111     \{
1112         \textcolor{comment}{/* restart detach detection timer */}
1113         \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer}, 
      \hyperlink{usb__pd__connect_8c_a8d7796b74237b4feb45dd20a191e76eb}{T\_PD\_DEBOUNCE});
1114         \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &
      infoVal);
1115         vbusPresent = ((infoVal & \hyperlink{group__usb__pd__phy__drv_ga1f2e4aed47a47caec2aba9edb2236e42}{PD\_VBUS\_POWER\_STATE\_VSAFE5V\_MASK}) || (
      infoVal & \hyperlink{group__usb__pd__phy__drv_gabe6758409c7aeff91de688fe7cefa195}{PD\_VBUS\_POWER\_STATE\_VBUS\_MASK}));
1116 
1117         \textcolor{comment}{/* A DRP that strongly prefers the Source role may optionally transition to Try.SRC instead of}
1118 \textcolor{comment}{           Attached.SNK when the state of only one CC pin has been SNK.Rp for at least tCCDebounce}
1119 \textcolor{comment}{           and VBUS is detected. */}
1120         \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) &&
1121             (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a6e72ee6532ef61497b162a28b4500433}{drpTryFunction} == 
      \hyperlink{group__usb__pd__stack_gga4794fa8903a011ba6f0be0f04925411ea4326df028c06c1618941dfac6645decd}{kTypecTry\_Src}) &&
1122             (((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) && (cc2State != 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp})) ||
1123              ((cc1State != \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}))) &&
1124             (\hyperlink{usb__pd__timer_8c_a3d4072fbbc7b10a05c795eaf9ed33f5f}{PD\_TimerCheckInvalidOrTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})) && (vbusPresent))
1125         \{
1126             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a4f775507f441bbd5fdd9b7af5a501f95}{TYPEC\_TRY\_SRC};
1127         \}
1128         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) && (cc2State != 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp})) && (vbusPresent) &&
1129                  (\hyperlink{usb__pd__timer_8c_a3d4072fbbc7b10a05c795eaf9ed33f5f}{PD\_TimerCheckInvalidOrTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})))
1130         \{
1131             \textcolor{comment}{/* The port shall transition to Attached.SNK after the state of only one of the CC1 or CC2 pins
       is}
1132 \textcolor{comment}{               SNK.Rp for at least tCCDebounce and VBUS is detected. */}
1133             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08dad8ccec791609837bd7b2cb928ba727b6}{kPD\_CC1};
1134             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK};
1135         \}
1136         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((cc1State != \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp})) && (vbusPresent) &&
1137                  (\hyperlink{usb__pd__timer_8c_a3d4072fbbc7b10a05c795eaf9ed33f5f}{PD\_TimerCheckInvalidOrTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})))
1138         \{
1139             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da274bd8ffe2629a7d89fb09b4848e172d}{kPD\_CC2};
1140             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a06a469da27f359966648eda899622706}{TYPEC\_ATTACHED\_SNK};
1141         \}
1142 \textcolor{preprocessor}{#if defined(PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT)}
1143 \textcolor{preprocessor}{}        \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->typecSnkRole == 
      \hyperlink{group__usb__pd__stack_gga6ba6df5e492767ce7ac52bafddd8849da870a709d39d5f94e62a5fc3e6872cb63}{kSinkConfig\_DebugAcc}) && (cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) &&
1144                  (cc2State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) && (vbusPresent) &&
1145                  (\hyperlink{usb__pd__timer_8c_a3d4072fbbc7b10a05c795eaf9ed33f5f}{PD\_TimerCheckInvalidOrTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})))
1146         \{
1147             \textcolor{comment}{/* If the port supports Debug Accessory Mode, the port shall transition to DebugAccessory.SNK}
1148 \textcolor{comment}{               if the state of both the CC1 and CC2 pins is SNK.Rp for at least tCCDebounce and VBUS is}
1149 \textcolor{comment}{               detected.  */}
1150             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
1151             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338abe78848b46b7ac825cdc24493593a500}{TYPEC\_DEBUG\_ACCESSORY\_SNK};
1152         \}
1153 \textcolor{preprocessor}{#endif}
1154 \textcolor{preprocessor}{}        \textcolor{keywordflow}{else}
1155         \{
1156         \}
1157     \}
1158 
1159     \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} != \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK})
1160     \{
1161         \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer});
1162         \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa1b228a3a8ff33d3bb22c0be2bbbb2c4a}{tPDDebounceTimer});
1163     \}
1164 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ad9e61e9e67e7d53a66151eae69b658d8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ad9e61e9e67e7d53a66151eae69b658d8_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_ae84ce27d88537e1fb4335d7cb8a304a5}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process@{P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process@{P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Snk\-Unattached\-Snk\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_ae84ce27d88537e1fb4335d7cb8a304a5}

\begin{DoxyCode}
1054 \{
1055     \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}) || (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaade47f2368d7c600c0c08f3e171116f47}{kCCState\_SnkRp}))
1056     \{
1057         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a124465c7bd8e60c18a2d0d232faea211}{TYPEC\_ATTACH\_WAIT\_SNK};
1058     \}
1059     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling})
1060     \{
1061         \textcolor{keywordflow}{if} (\hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}))
1062         \{
1063             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}{T\_DRP\_TOGGLE\_SRC});
1064             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
1065         \}
1066     \}
1067     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{usb__pd__config_8h_a817f4917f983cd86ca2f8e03713a490d}{PD\_CONFIG\_SINK\_ACCESSORY\_SUPPORT})
1068     \{
1069         \textcolor{comment}{/* This state is functionally equivalent to the Unattached.SRC state in a DRP, except that}
1070 \textcolor{comment}{        Attached.SRC is not supported.}
1071 \textcolor{comment}{        The port shall provide an Rp */}
1072         \textcolor{keywordflow}{if} (\hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}))
1073         \{
1074             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_ac3cb57a6866514e5c7cb6996a2c9bf69}{T\_DRP\_TOGGLE\_SRC});
1075             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a48a06d065d2a479f3ad3baf0786e954f}{TYPEC\_UNATTACHED\_ACCESSORY};
1076         \}
1077     \}
1078     \textcolor{keywordflow}{else}
1079     \{
1080     \}
1081 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ae84ce27d88537e1fb4335d7cb8a304a5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_ae84ce27d88537e1fb4335d7cb8a304a5_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a3941fedd707bcdc334532b184d27787f}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process@{P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process@{P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Src\-Attached\-Src\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a3941fedd707bcdc334532b184d27787f}

\begin{DoxyCode}
1256 \{
1257     \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} != \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771bac6be16e80130e6e9909ce3075565f39b}{kVbusPower\_InPRSwap}) && (pdInstance->
      \hyperlink{struct__pd__instance_af4167196731cf1a846f23c4d6473181c}{inProgress} != \hyperlink{group__usb__pd__stack_gga1af9af0106a9413093f8e0d9b796771badfb60998cac82d001b52af44674eef18}{kVbusPower\_InFRSwap}))
1258     \{
1259         \textcolor{comment}{/* When the SRC.Open state is detected on the monitored CC pin, a DRP shall transition to}
1260 \textcolor{comment}{           Unattached.SNK unless it strongly prefers the Source role. In that case, it shall transition to}
1261 \textcolor{comment}{           TryWait.SNK. This transition to TryWait.SNK is needed so that two devices that both prefer}
1262 \textcolor{comment}{           the Source role do not loop endlessly between Source and Sink. In other words, a DRP that}
1263 \textcolor{comment}{           would enter Try.SRC from AttachWait.SNK shall enter TryWait.SNK for a Sink detach from}
1264 \textcolor{comment}{           Attached.SRC. */}
1265         \textcolor{keywordflow}{if} (((pdInstance->\hyperlink{struct__pd__instance_ae190e16d15f42371ac82937f08371c98}{cc1Monitor}) && ((cc1State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen}) || (cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaad9c10479d9b8c3ead23386b15c857458}{kCCState\_Unknown}))) ||
1266             ((pdInstance->\hyperlink{struct__pd__instance_af6e379f0550864c814e92c07732b6ea9}{cc2Monitor}) && ((cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen}) || (cc2State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaad9c10479d9b8c3ead23386b15c857458}{kCCState\_Unknown}))))
1267         \{
1268             \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a6e72ee6532ef61497b162a28b4500433}{drpTryFunction} == 
      \hyperlink{group__usb__pd__stack_gga4794fa8903a011ba6f0be0f04925411ea4326df028c06c1618941dfac6645decd}{kTypecTry\_Src}) &&
1269                 (pdInstance->\hyperlink{struct__pd__instance_aea1b390f81517cb7ef24eacda944f4ec}{enterAttachedSrcFromAttachWaitSNK}))
1270             \{
1271                 pdInstance->\hyperlink{struct__pd__instance_aea1b390f81517cb7ef24eacda944f4ec}{enterAttachedSrcFromAttachWaitSNK} = 0;
1272                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a2b1c7d8d21f96cfad356308863269872}{TYPEC\_TRY\_WAIT\_SNK};
1273             \}
1274             \textcolor{keywordflow}{else}
1275             \{
1276                 \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling})
1277                 \{
1278                     pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST};
1279                 \}
1280                 \textcolor{keywordflow}{else}
1281                 \{
1282                     pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
1283                 \}
1284             \}
1285             pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge};
1286         \}
1287     \}
1288 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a3941fedd707bcdc334532b184d27787f_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a6313417f32370723f208ee8129f7348b}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process@{P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process@{P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Src\-Attach\-Wait\-Src\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_a6313417f32370723f208ee8129f7348b}

\begin{DoxyCode}
647 \{
648     uint32\_t infoVal;
649 
650     \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &infoVal
      );
651 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_COMPLIANCE\_TEST\_ENABLE) && (PD\_CONFIG\_COMPLIANCE\_TEST\_ENABLE)}
652 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (!(infoVal & \hyperlink{group__usb__pd__phy__drv_gabf05bb09647628f3556c817e1f059175}{PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK}))
653     \{
654         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
655     \}
656     \textcolor{keywordflow}{else}
657 \textcolor{preprocessor}{#endif}
658 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen})) ||
659             ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen})) ||
660             ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaac26b04a9aef09cf82b2b01c5d775ad40}{kCCState\_SrcOpen}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa})))
661     \{
662         \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling})
663         \{
664             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST};
665         \}
666         \textcolor{keywordflow}{else}
667         \{
668             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
669         \}
670     \}
671     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling}) &&
672              (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a6e72ee6532ef61497b162a28b4500433}{drpTryFunction} == 
      \hyperlink{group__usb__pd__stack_gga4794fa8903a011ba6f0be0f04925411ea96a98ce2756ccbcd3c300db89ae9be67}{kTypecTry\_Snk}) &&
673              (((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) && (cc2State != 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd})) ||
674               ((cc1State != \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}))) &&
675              (infoVal & PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK) && (
      \hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})))
676     \{
677         pdInstance->\hyperlink{struct__pd__instance_a83ce4a62d8bb8f280b4fb7fdbcdc8d5a}{enterTrySNKFromPoweredAcc} = 0;
678         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338aba1f316befeaf678024cd17f6d359410}{TYPEC\_TRY\_SNK};
679     \}
680     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) && (cc2State != 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) &&
681              ((infoVal & PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK)) &&
682              (\hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})))
683     \{
684         pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08dad8ccec791609837bd7b2cb928ba727b6}{kPD\_CC1};
685         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC};
686     \}
687     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((cc2State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) && (cc1State != 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) &&
688              (infoVal & PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK) && (
      \hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer})))
689     \{
690         pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da274bd8ffe2629a7d89fb09b4848e172d}{kPD\_CC2};
691         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC};
692     \}
693 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_AUDIO\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_AUDIO\_ACCESSORY\_SUPPORT)}
694 \textcolor{preprocessor}{}    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}))
695     \{
696         pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08dad8ccec791609837bd7b2cb928ba727b6}{kPD\_CC1};
697         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1e60a88a2cd942ba4bd065ee2b9438d3}{TYPEC\_AUDIO\_ACCESSORY};
698     \}
699 \textcolor{preprocessor}{#else}
700 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if (defined PD\_CONFIG\_PTN5110\_PORT) && (PD\_CONFIG\_PTN5110\_PORT > 0)}
701 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if defined(USBPD\_ENABLE\_PTN5110\_A0R1\_WORKAROUNDS) && (USBPD\_ENABLE\_PTN5110\_A0R1\_WORKAROUNDS)}
702 \textcolor{preprocessor}{}    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_a8cf1d14cc029410e591cbfe30d5b2cd9}{phyInfo}.\hyperlink{struct__pd__phy__vendor__info_a271bbac00bad57c93a70cfb905bb2d98}{vendorID} == \hyperlink{group__usb__pd__stack_gab5c70518a449d87b8e044fe35f9794b9}{PD\_VENDOR\_ID\_NXP}) &&
703              (pdInstance->\hyperlink{struct__pd__instance_a8cf1d14cc029410e591cbfe30d5b2cd9}{phyInfo}.\hyperlink{struct__pd__phy__vendor__info_a4bd651a05bc50ad4e045b7956ba6f43b}{productID} == 
      \hyperlink{usb__pd__ptn5110_8h_adf3515b9e7855268cdfd61832d4c8eb2}{PRODUCT\_ID\_PTN5110}) &&
704              (pdInstance->\hyperlink{struct__pd__instance_a8cf1d14cc029410e591cbfe30d5b2cd9}{phyInfo}.\hyperlink{struct__pd__phy__vendor__info_a356dba0c0968b8a08fee4477f561ea46}{deviceID} < 
      \hyperlink{usb__pd__ptn5110_8h_af391565501d18ab2f4f923593997b06e}{DEVICE\_ID\_PTN5110\_A0R1}))
705     \{
706         \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}) &&
707             (infoVal & PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK))
708         \{
709             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
710             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC};
711         \}
712     \}
713 \textcolor{preprocessor}{#endif}
714 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
715 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
716 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if defined(PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT) && (PD\_CONFIG\_DEBUG\_ACCESSORY\_SUPPORT)}
717 \textcolor{preprocessor}{}    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}))
718     \{
719         pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
720         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a09376cb7ece9c3734d29379623b63a69}{TYPEC\_UNORIENTED\_DEBUG\_ACCESSORY\_SRC};
721     \}
722 \textcolor{preprocessor}{#else}
723 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if (defined PD\_CONFIG\_PTN5110\_PORT) && (PD\_CONFIG\_PTN5110\_PORT > 0)}
724 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if defined(USBPD\_ENABLE\_PTN5110\_A0R1\_WORKAROUNDS) && (USBPD\_ENABLE\_PTN5110\_A0R1\_WORKAROUNDS)}
725 \textcolor{preprocessor}{}    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_a8cf1d14cc029410e591cbfe30d5b2cd9}{phyInfo}.\hyperlink{struct__pd__phy__vendor__info_a271bbac00bad57c93a70cfb905bb2d98}{vendorID} == \hyperlink{group__usb__pd__stack_gab5c70518a449d87b8e044fe35f9794b9}{PD\_VENDOR\_ID\_NXP}) &&
726              (pdInstance->\hyperlink{struct__pd__instance_a8cf1d14cc029410e591cbfe30d5b2cd9}{phyInfo}.\hyperlink{struct__pd__phy__vendor__info_a4bd651a05bc50ad4e045b7956ba6f43b}{productID} == 
      \hyperlink{usb__pd__ptn5110_8h_adf3515b9e7855268cdfd61832d4c8eb2}{PRODUCT\_ID\_PTN5110}) &&
727              (pdInstance->\hyperlink{struct__pd__instance_a8cf1d14cc029410e591cbfe30d5b2cd9}{phyInfo}.\hyperlink{struct__pd__phy__vendor__info_a356dba0c0968b8a08fee4477f561ea46}{deviceID} < 
      \hyperlink{usb__pd__ptn5110_8h_af391565501d18ab2f4f923593997b06e}{DEVICE\_ID\_PTN5110\_A0R1}))
728     \{
729         \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) &&
730             (infoVal & PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK))
731         \{
732             pdInstance->\hyperlink{struct__pd__instance_a0087c1b246d026c864194bf77ebcf654}{ccUsed} = \hyperlink{group__usb__pd__phy__drv_ggab23c0fba94b457218944bc5284d0d08da38c70fd9b523ca5666dea46ae65119ce}{kPD\_CCInvalid};
733             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a08ce67bf9e0a4d46237c40642b049bcc}{TYPEC\_ATTACHED\_SRC};
734         \}
735     \}
736 \textcolor{preprocessor}{#endif}
737 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
738 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
739 \textcolor{preprocessor}{}    \textcolor{keywordflow}{else}
740     \{
741     \}
742 
743     \textcolor{comment}{/* exit process */}
744     \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} != \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC})
745     \{
746         \textcolor{comment}{/* 1. start the timer when enter TYPEC\_ATTACH\_WAIT\_SRC; 2. end the tiemr when exit
       TYPEC\_ATTACH\_WAIT\_SRC */}
747         \hyperlink{usb__pd__timer_8c_a453ba4a7609afd86d5e6b9fb8759b6b5}{PD\_TimerClear}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa78f7a86378be2dc1e04556c6cb80e8c5}{tCCDebounceTimer});
748     \}
749 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a6313417f32370723f208ee8129f7348b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a6313417f32370723f208ee8129f7348b_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_af6d40e216e9c36436e8363ff28113a3a}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process@{P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process}}
\index{P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process@{P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process}]{\setlength{\rightskip}{0pt plus 5cm}static void P\-D\-\_\-\-Connect\-State\-Src\-Unattached\-Src\-Process (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{cc1\-State, }
\item[{uint8\-\_\-t}]{cc2\-State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{usb__pd__connect_8c_af6d40e216e9c36436e8363ff28113a3a}

\begin{DoxyCode}
609 \{
610     uint32\_t infoVal;
611 
612     \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, &infoVal
      );
613     \textcolor{keywordflow}{if} ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) || (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaaa412476134fd446143c0e7275b5c329f}{kCCState\_SrcRd}) ||
614         ((cc1State == \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa}) && (cc2State == 
      \hyperlink{group__usb__pd__phy__drv_gga09172da56b484f99a2ee891e75882faaab1f4f45b18f4f5729a23ef05ba9c741d}{kCCState\_SrcRa})))
615     \{
616         pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC};
617 
618 \textcolor{preprocessor}{#if (defined PD\_CONFIG\_COMPLIANCE\_TEST\_ENABLE) && (PD\_CONFIG\_COMPLIANCE\_TEST\_ENABLE)}
619 \textcolor{preprocessor}{}        \textcolor{comment}{/* If the TCPC has incorrectly entered AttachWait.SRC with VBus not at VSafe0V, */}
620         \textcolor{comment}{/* then move to Unattached.SRC instead. */}
621         \textcolor{keywordflow}{if} ((pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} == \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a0175480705eb6d9c36ab579036e9bbc7}{TYPEC\_ATTACH\_WAIT\_SRC}))
622         \{
623             uint32\_t infoVal;
624             \hyperlink{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3eda4a23adc388bf03852d850ff3919328d6}{PD\_PHY\_GET\_VBUS\_POWER\_STATE}, 
      &infoVal);
625             \textcolor{keywordflow}{if} (!(infoVal & \hyperlink{group__usb__pd__phy__drv_gabf05bb09647628f3556c817e1f059175}{PD\_VBUS\_POWER\_STATE\_VSAFE0V\_MASK}))
626             \{
627                 pdInstance->\hyperlink{struct__pd__instance_a4905e96236b6de63bba2c1d34c5a0a8b}{vbusDischargeInProgress} = 
      \hyperlink{usb__pd__connect_8c_a99f1687ace9dc35cfd53f6669eca30afab0152ba85efd984aa8ed55d4a98b3f32}{kVbus\_ApplyTypecDischarge};
628                 pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = 
      \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338ad3a44a4534b93aaf59db03272710a580}{TYPEC\_UNATTACHED\_SRC};
629             \}
630         \}
631 \textcolor{preprocessor}{#endif}
632 \textcolor{preprocessor}{}    \}
633     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pdInstance->\hyperlink{struct__pd__instance_aa7854ddf70e64f92b178cc5d787037a2}{pdPowerPortConfig}->\hyperlink{struct__pd__power__port__config_a649079672f270a65578bd41e0e624e16}{typecRole} == 
      \hyperlink{group__usb__pd__stack_ggaffef947540aace08ecf6fd25f69720a9a9b59768282ea23a087cc0912e4516cae}{kPowerConfig\_DRPToggling})
634     \{
635         \textcolor{keywordflow}{if} (\hyperlink{usb__pd__timer_8c_afd2f667e16635d3db0523f13afe7610c}{PD\_TimerCheckValidTimeOut}(pdInstance, 
      \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}))
636         \{
637             \hyperlink{usb__pd__timer_8c_afa3b5394c429c185ea93be16ddb1545f}{PD\_TimerStart}(pdInstance, \hyperlink{usb__pd__timer_8h_a94e23fe7d4bf2bf6f8de1f51126d071fa304ba914f5eb1a7d1ba82292cc8fcb81}{tDRPToggleTimer}, 
      \hyperlink{usb__pd__connect_8c_a837f610221411da8297162bb2ee1d213}{T\_DRP\_TOGGLE\_SNK});
638             pdInstance->\hyperlink{struct__pd__instance_a2c4dd56715311bcb898a01a7cbec1609}{curConnectState} = \hyperlink{usb__pd__spec_8h_a9a1674d34c926c8ecd0f9f70e2da0338a1b001a7ceaf22f44b51faa345597b5b9}{TYPEC\_TOGGLE\_SNK\_FIRST};
639         \}
640     \}
641     \textcolor{keywordflow}{else}
642     \{
643     \}
644 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_af6d40e216e9c36436e8363ff28113a3a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_af6d40e216e9c36436e8363ff28113a3a_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Dpm\-Discharge\-Vbus@{P\-D\-\_\-\-Dpm\-Discharge\-Vbus}}
\index{P\-D\-\_\-\-Dpm\-Discharge\-Vbus@{P\-D\-\_\-\-Dpm\-Discharge\-Vbus}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Dpm\-Discharge\-Vbus}]{\setlength{\rightskip}{0pt plus 5cm}void P\-D\-\_\-\-Dpm\-Discharge\-Vbus (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint8\-\_\-t}]{enable}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa}

\begin{DoxyCode}
6534 \{
6535     \hyperlink{usb__pd__policy_8c_a555b1880b5b259c3fdcd3da821e06cf2}{PD\_PhyControl}(pdInstance, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edae705da68d4de3104b6852d84715bb71b}{PD\_PHY\_DISCHARGE\_VBUS}, &enable);
6536 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a8afdb6c45b33f168a2fb95395714bdfa_icgraph}
\end{center}
\end{figure}


\hypertarget{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}{\index{usb\-\_\-pd\-\_\-connect.\-c@{usb\-\_\-pd\-\_\-connect.\-c}!P\-D\-\_\-\-Phy\-Control@{P\-D\-\_\-\-Phy\-Control}}
\index{P\-D\-\_\-\-Phy\-Control@{P\-D\-\_\-\-Phy\-Control}!usb_pd_connect.c@{usb\-\_\-pd\-\_\-connect.\-c}}
\subsubsection[{P\-D\-\_\-\-Phy\-Control}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pd\-\_\-status\-\_\-t} P\-D\-\_\-\-Phy\-Control (
\begin{DoxyParamCaption}
\item[{{\bf pd\-\_\-instance\-\_\-t} $\ast$}]{pd\-Instance, }
\item[{uint32\-\_\-t}]{control, }
\item[{void $\ast$}]{param}
\end{DoxyParamCaption}
)}}\label{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2}

\begin{DoxyCode}
123 \{
124     \textcolor{comment}{// usb\_pd\_phy.h: pd\_phy\_control\_t enum}
125     \textcolor{keywordflow}{if} ((control == \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadd7a49b2857f7cc9b4708cb899950eec}{PD\_PHY\_UPDATE\_STATE}) ||
126         (\hyperlink{group__usb__os__abstraction_gab25fb5d93d3b665ca8eadf2a670d3361}{USB\_OsaEventCheck}(pdInstance->\hyperlink{struct__pd__instance_ab04e9fcc994b2547509169e07ab21465}{taskEventHandle}, 
      \hyperlink{usb__pd__interface_8h_a08a5013301d9587b47017854a2ee5981ac05d4679325cb8c3a8491b9812e28924}{PD\_TASK\_EVENT\_PHY\_STATE\_CHAGNE}, NULL) ==
127          \hyperlink{group__usb__os__abstraction_gga453ebd2f93aafb8c938c3a23c815f9bdab90805fb75297fda1ca60dbb2283f933}{kStatus\_USB\_OSA\_Success}))
128     \{
129         \hyperlink{group__usb__os__abstraction_ga90357f04d40469dc07104033b3c8581c}{USB\_OsaEventClear}(pdInstance->\hyperlink{struct__pd__instance_ab04e9fcc994b2547509169e07ab21465}{taskEventHandle}, 
      \hyperlink{usb__pd__interface_8h_a08a5013301d9587b47017854a2ee5981ac05d4679325cb8c3a8491b9812e28924}{PD\_TASK\_EVENT\_PHY\_STATE\_CHAGNE});
130         \textcolor{comment}{// pd/usb\_pd\_interface.c中初始化，对应phy中的control函数}
131         pdInstance->\hyperlink{struct__pd__instance_adbed7b2cd53df40e0611a8879c903339}{phyInterface}->\hyperlink{struct__pd__phy__api__interface_a5e422dbfd66fca34934e39b451f17094}{pdPhyControl}(pdInstance->
      \hyperlink{struct__pd__instance_a7c1184292efe9a5ae30b6ac422c1e9f4}{pdPhyHandle}, \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadd7a49b2857f7cc9b4708cb899950eec}{PD\_PHY\_UPDATE\_STATE}, NULL);
132         NVIC\_EnableIRQ((IRQn\_Type)pdInstance->\hyperlink{struct__pd__instance_a2d9a457d63da9c4cb5e3feece0cbf3ec}{pdConfig}->\hyperlink{struct__pd__instance__config_a131f930f58f1a9bfe1488acb62aa2725}{phyInterruptNum});
133     \}
134 
135     \textcolor{comment}{// call PDPTN5110\_Control}
136     \textcolor{keywordflow}{if} (control != \hyperlink{group__usb__pd__phy__drv_ggab8bfca50e2ac042b47a697c88f84c3edadd7a49b2857f7cc9b4708cb899950eec}{PD\_PHY\_UPDATE\_STATE})
137     \{
138         \textcolor{keywordflow}{return} pdInstance->\hyperlink{struct__pd__instance_adbed7b2cd53df40e0611a8879c903339}{phyInterface}->\hyperlink{struct__pd__phy__api__interface_a5e422dbfd66fca34934e39b451f17094}{pdPhyControl}(pdInstance->
      \hyperlink{struct__pd__instance_a7c1184292efe9a5ae30b6ac422c1e9f4}{pdPhyHandle}, control, param);
139     \}
140     \textcolor{keywordflow}{else}
141     \{
142         \textcolor{keywordflow}{return} \hyperlink{group__usb__pd__stack_ggaaad4cd00dd02567c6169429e3a895073acf06f954f9c52f560cea34df48c63555}{kStatus\_PD\_Success};
143     \}
144 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{usb__pd__connect_8c_a555b1880b5b259c3fdcd3da821e06cf2_icgraph}
\end{center}
\end{figure}


