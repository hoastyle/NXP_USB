\hypertarget{battery_2pd__command__interface_8c}{\section{demo/pd\-\_\-battery/pd\-\_\-command\-\_\-interface.c File Reference}
\label{battery_2pd__command__interface_8c}\index{demo/pd\-\_\-battery/pd\-\_\-command\-\_\-interface.\-c@{demo/pd\-\_\-battery/pd\-\_\-command\-\_\-interface.\-c}}
}
{\ttfamily \#include \char`\"{}usb\-\_\-pd\-\_\-config.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\-\_\-pd.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}string.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Free\-R\-T\-O\-S.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}queue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}timers.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pd\-\_\-app.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fsl\-\_\-device\-\_\-registers.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fsl\-\_\-lptmr.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fsl\-\_\-port.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fsl\-\_\-debug\-\_\-console.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fsl\-\_\-gpio.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}board.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pd\-\_\-power\-\_\-interface.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pd\-\_\-command\-\_\-interface.\-h\char`\"{}}\\*
Include dependency graph for pd\-\_\-command\-\_\-interface.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{battery_2pd__command__interface_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__usb__pd__stack_ga04a1f331d9807a70ab9bb753f5ed1c80}{pd\-\_\-status\-\_\-t} \hyperlink{battery_2pd__command__interface_8c_a336eb892659ecb2d1392ebf1839a0b18}{P\-D\-\_\-\-Dpm\-App\-Command\-Callback} (void $\ast$callback\-Param, uint32\-\_\-t event, void $\ast$param)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{battery_2pd__command__interface_8c_a336eb892659ecb2d1392ebf1839a0b18}{\index{battery/pd\-\_\-command\-\_\-interface.\-c@{battery/pd\-\_\-command\-\_\-interface.\-c}!P\-D\-\_\-\-Dpm\-App\-Command\-Callback@{P\-D\-\_\-\-Dpm\-App\-Command\-Callback}}
\index{P\-D\-\_\-\-Dpm\-App\-Command\-Callback@{P\-D\-\_\-\-Dpm\-App\-Command\-Callback}!battery/pd_command_interface.c@{battery/pd\-\_\-command\-\_\-interface.\-c}}
\subsubsection[{P\-D\-\_\-\-Dpm\-App\-Command\-Callback}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pd\-\_\-status\-\_\-t} P\-D\-\_\-\-Dpm\-App\-Command\-Callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{callback\-Param, }
\item[{uint32\-\_\-t}]{event, }
\item[{void $\ast$}]{param}
\end{DoxyParamCaption}
)}}\label{battery_2pd__command__interface_8c_a336eb892659ecb2d1392ebf1839a0b18}

\begin{DoxyCode}
65 \{
66     \hyperlink{group__usb__pd__stack_ga04a1f331d9807a70ab9bb753f5ed1c80}{pd\_status\_t} status = \hyperlink{group__usb__pd__stack_ggaaad4cd00dd02567c6169429e3a895073a4d58370b8ee8d3d2a4c477f7a3f84dda}{kStatus\_PD\_Error};
67 
68     \textcolor{keywordflow}{switch} (event)
69     \{
70         \textcolor{comment}{/* hard reset */}
71         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a65ddff38ff9b959107bdabc53a1d1713}{PD\_DPM\_SNK\_HARD\_RESET\_REQUEST}:
72         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a64e92f523589e05e41df27ce310855ae}{PD\_DPM\_SRC\_HARD\_RESET\_REQUEST}:
73             status = \hyperlink{pd__command__app_8c_a34306bb735461e522c573f87e8a4049b}{PD\_DpmHardResetCallback}(callbackParam);
74             \textcolor{keywordflow}{break};
75 
76         \textcolor{comment}{/* pr\_swap */}
77         \textcolor{comment}{/* fast role swap */}
78         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a92e06fee7178623887fe1d895ae3ffa3}{PD\_DPM\_PR\_SWAP\_REQUEST}:
79         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8ab8e9c9690239a89c37d446bf4b35122c}{PD\_DPM\_FR\_SWAP\_REQUEST}:
80             status =
81                 \hyperlink{pd__command__app_8c_a1d232a97d0a852565547c1952e83faa6}{PD\_DpmPowerRoleSwapRequestCallback}(callbackParam, (event 
      == \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8ab8e9c9690239a89c37d446bf4b35122c}{PD\_DPM\_FR\_SWAP\_REQUEST}), (uint8\_t *)param);
82             \textcolor{keywordflow}{break};
83         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a97a7759c15d78fc8c7a1e53f522c7799}{PD\_DPM\_PR\_SWAP\_SUCCESS}:
84         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a2d0a8b5453cd82a137805d3b023b264d}{PD\_DPM\_FR\_SWAP\_SUCCESS}:
85             status = \hyperlink{pd__command__app_8c_a3d92f8202fc73da16faf6d8496bae858}{PD\_DpmPowerRoleSwapResultCallback}(callbackParam, 1, 0
      );
86             \textcolor{keywordflow}{break};
87         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a34537a7fbc8f9182d14d4ef32607f7c5}{PD\_DPM\_PR\_SWAP\_FAIL}:
88         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a410336358bacd4292bc294c26d850275}{PD\_DPM\_FR\_SWAP\_FAIL}:
89             status = \hyperlink{pd__command__app_8c_a3d92f8202fc73da16faf6d8496bae858}{PD\_DpmPowerRoleSwapResultCallback}(callbackParam, 0, *
      ((uint8\_t *)param));
90             \textcolor{keywordflow}{break};
91 
92         \textcolor{comment}{/* vconn swap */}
93         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8ab62a576276285565837d94af7a289378}{PD\_DPM\_VCONN\_SWAP\_REQUEST}:
94             status = \hyperlink{pd__command__app_8c_ac9514370755ca84c517e49e833ada971}{PD\_DpmVconnSwapRequestCallback}(callbackParam, (uint8\_t 
      *)param);
95             \textcolor{keywordflow}{break};
96         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a599ef1b2e4b2ac816d5eebb00afc6bd6}{PD\_DPM\_VCONN\_SWAP\_SUCCESS}:
97             status = \hyperlink{pd__command__app_8c_a6f9aaba280e24edd2c837cd689d50eeb}{PD\_DpmVconnSwapResultCallback}(callbackParam, 1, 0);
98             \textcolor{keywordflow}{break};
99         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a7d1d0c1a00df8f90177fef2eaf7f1831}{PD\_DPM\_VCONN\_SWAP\_FAIL}:
100             status = \hyperlink{pd__command__app_8c_a6f9aaba280e24edd2c837cd689d50eeb}{PD\_DpmVconnSwapResultCallback}(callbackParam, 0, *((
      uint8\_t *)param));
101             \textcolor{keywordflow}{break};
102 
103         \textcolor{comment}{/* rdo request and power negotiation */}
104         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a49dbf9ff2b5fba3ef05e0bf4da9ee7f6}{PD\_DPM\_SRC\_RDO\_REQUEST}:
105             status = \hyperlink{pd__command__app_8c_a0012931c6c686dd4bdab89e0b3c6414d}{PD\_DpmSrcRDORequestCallback}(callbackParam, ((
      \hyperlink{struct__pd__negotiate__power__request}{pd\_negotiate\_power\_request\_t} *)param)->rdo,
106                                                  &(((
      \hyperlink{struct__pd__negotiate__power__request}{pd\_negotiate\_power\_request\_t} *)param)->negotiateResult));
107             \textcolor{keywordflow}{break};
108         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a2ec99737c513a5308eaf1dabf39b7486}{PD\_DPM\_SRC\_CONTRACT\_STILL\_VALID}:
109             status = \hyperlink{pd__command__app_8c_a098ead626f2b20fb29afb3e8b9d5350b}{PD\_DpmSrcPreContractStillValidCallback}(
      callbackParam, (uint8\_t *)param);
110             \textcolor{keywordflow}{break};
111         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a1811ccedaf6c42290ef3311d01d3be92}{PD\_DPM\_SRC\_SEND\_SRC\_CAP\_FAIL}:
112             status = \hyperlink{pd__command__app_8c_a67ae7c023946ebdcdb306e1e96b3f45e}{PD\_DpmSrcRDOResultCallback}(callbackParam, 0, 
      \hyperlink{group__usb__pd__stack_ggaa0c9fbfbfb4442ef9d805438bfeb045ca2037b8a85f98d8d2413d589dbe7ea4fd}{kCommandResult\_Error});
113             \textcolor{keywordflow}{break};
114         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a212a13db5a2a86d25d5e4e9bd9bd9d40}{PD\_DPM\_SRC\_RDO\_SUCCESS}:
115             status = \hyperlink{pd__command__app_8c_a67ae7c023946ebdcdb306e1e96b3f45e}{PD\_DpmSrcRDOResultCallback}(callbackParam, 1, 0);
116             \textcolor{keywordflow}{break};
117         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a83108cfc7a063655541fa36c59b8ace8}{PD\_DPM\_SRC\_RDO\_FAIL}:
118             status = \hyperlink{pd__command__app_8c_a67ae7c023946ebdcdb306e1e96b3f45e}{PD\_DpmSrcRDOResultCallback}(callbackParam, 0, *((uint8\_t *)
      param));
119             \textcolor{keywordflow}{break};
120         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a73f52811ed1d7307f82f21ec46a09f24}{PD\_DPM\_SNK\_RECEIVE\_PARTNER\_SRC\_CAP}:
121             status = \hyperlink{pd__command__app_8c_aef2aa35be6feb902cbecde3673322473}{PD\_DpmReceivePartnerSrcCapsCallback}(callbackParam, 
      (\hyperlink{struct__pd__capabilities}{pd\_capabilities\_t} *)param);
122             \textcolor{keywordflow}{break};
123         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a7ae766d14391a18afed566fc89aab26a}{PD\_DPM\_SNK\_GET\_RDO}:
124             status = \hyperlink{pd__command__app_8c_adcf04a0dae4086c9517955cf3d447126}{PD\_DpmSnkGetRequestRDOCallback}(callbackParam, (
      \hyperlink{struct__pd__rdo}{pd\_rdo\_t} *)param);
125             \textcolor{keywordflow}{break};
126         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a1439b92e5316a3eac87950f7ee737890}{PD\_DPM\_SNK\_RDO\_SUCCESS}:
127             status = \hyperlink{pd__command__app_8c_a1a5c446f863f9b45b09e5b428c5c2613}{PD\_DpmSnkRDOResultCallback}(callbackParam, 1, 0);
128             \textcolor{keywordflow}{break};
129         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8aa3476563b037797a05c3aeaeb347dc7c}{PD\_DPM\_SNK\_RDO\_FAIL}:
130             status = \hyperlink{pd__command__app_8c_a1a5c446f863f9b45b09e5b428c5c2613}{PD\_DpmSnkRDOResultCallback}(callbackParam, 0, *((uint8\_t *)
      param));
131             \textcolor{keywordflow}{break};
132 
133         \textcolor{comment}{/* get source cap */}
134         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8aee9e5991d19424456884d183c3892e84}{PD\_DPM\_GET\_PARTNER\_SRC\_CAP\_FAIL}:
135             status = \hyperlink{pd__command__app_8c_a5043c66ba7fcf337c4333144f43ed630}{PD\_DpmGetPartnerSrcCapsFailCallback}(callbackParam, 
      *((uint8\_t *)param));
136             \textcolor{keywordflow}{break};
137         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8aad63fc26b7c90d0b0882d09609f03c82}{PD\_DPM\_GET\_PARTNER\_SRC\_CAP\_SUCCESS}:
138             status = \hyperlink{pd__command__app_8c_aef2aa35be6feb902cbecde3673322473}{PD\_DpmReceivePartnerSrcCapsCallback}(callbackParam, 
      (\hyperlink{struct__pd__capabilities}{pd\_capabilities\_t} *)param);
139             \textcolor{keywordflow}{break};
140 
141         \textcolor{comment}{/* goto min */}
142         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8af4df2566f7dfb5614eab4183fd49d3bb}{PD\_DPM\_SRC\_GOTOMIN\_FAIL}:
143             status = \hyperlink{pd__command__app_8c_afcdd95ee527ae1405c5d816317badd5f}{PD\_DpmSrcGotoMinResultCallback}(callbackParam, 0, *((
      uint8\_t *)param));
144             \textcolor{keywordflow}{break};
145         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a818c91e1b20cc978318777720f2c7a3b}{PD\_DPM\_SRC\_GOTOMIN\_SUCCESS}:
146             status = \hyperlink{pd__command__app_8c_afcdd95ee527ae1405c5d816317badd5f}{PD\_DpmSrcGotoMinResultCallback}(callbackParam, 1, 0);
147             \textcolor{keywordflow}{break};
148         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8ae8334e4d49acc42ad9f6365c19f4cad1}{PD\_DPM\_SNK\_GOTOMIN\_SUCCESS}:
149             status = \hyperlink{pd__command__app_8c_ad4459653e54df154cb838bea4ccfd4e1}{PD\_DpmSnkGotoMinResultCallback}(callbackParam, 1, 0);
150             \textcolor{keywordflow}{break};
151         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8ac8eef85341e9ed1414592961c242e1e2}{PD\_DPM\_SNK\_GOTOMIN\_FAIL}:
152             status = \hyperlink{pd__command__app_8c_ad4459653e54df154cb838bea4ccfd4e1}{PD\_DpmSnkGotoMinResultCallback}(callbackParam, 0, *((
      uint8\_t *)param));
153             \textcolor{keywordflow}{break};
154 
155         \textcolor{comment}{/* get sink cap */}
156         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8acf7e85712657f05298823cf3cbb530dd}{PD\_DPM\_GET\_PARTNER\_SNK\_CAP\_SUCCESS}:
157             status = \hyperlink{pd__command__app_8c_adfab2b7d8a3ba6b4a8e138ac138d2398}{PD\_DpmReceivePartnerSnkCapsCallback}(callbackParam, 
      (\hyperlink{struct__pd__capabilities}{pd\_capabilities\_t} *)param);
158             \textcolor{keywordflow}{break};
159         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a2b5e3e788da63ca93c05e4723fbd6046}{PD\_DPM\_GET\_PARTNER\_SNK\_CAP\_FAIL}:
160             status = \hyperlink{pd__command__app_8c_ac82c79e04c70ce07454c8549666b7d5f}{PD\_DpmGetPartnerSnkCapsFailCallback}(callbackParam, 
      *((uint8\_t *)param));
161             \textcolor{keywordflow}{break};
162 
163         \textcolor{comment}{/* soft reset */}
164         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8ad1d3a3dd48dcbb93d29eee4e09093770}{PD\_DPM\_SOFT\_RESET\_SUCCESS}:
165         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a55e5b428b44bfbcef61a8fc137370c60}{PD\_DPM\_SOFT\_RESET\_REQUEST}:
166             status = \hyperlink{pd__command__app_8c_a9a594323bf987df556436495d9d6dd2a}{PD\_DpmSoftResetCallback}(callbackParam);
167             \textcolor{keywordflow}{break};
168         \textcolor{keywordflow}{case} \hyperlink{group__usb__pd__stack_gga6e10571af6af1a42760ea442ab580eb8a0c22065d3fb71fbfef9abe1a385dd661}{PD\_DPM\_SOFT\_RESET\_FAIL}:
169             \textcolor{comment}{/* in normal situation, app don't need process it PD stack will do hard\_reset if soft\_reset
       fail. */}
170             \textcolor{keywordflow}{break};
171 
172         \textcolor{keywordflow}{default}:
173             \textcolor{keywordflow}{break};
174     \}
175     \textcolor{keywordflow}{return} status;
176 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{battery_2pd__command__interface_8c_a336eb892659ecb2d1392ebf1839a0b18_cgraph}
\end{center}
\end{figure}


